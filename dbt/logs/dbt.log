[0m19:32:25.026709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f65f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f65c10>]}


============================== 19:32:25.045772 | 3b7fb42c-6683-401d-8038-efe476bbe79a ==============================
[0m19:32:25.045772 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:32:25.046141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ericliao/climate_elt/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:32:25.842007 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:32:25.842300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b7fb42c-6683-401d-8038-efe476bbe79a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fab550>]}
[0m19:32:25.900114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b7fb42c-6683-401d-8038-efe476bbe79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041740d0>]}
[0m19:32:25.931435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b7fb42c-6683-401d-8038-efe476bbe79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408b910>]}
[0m19:32:25.933779 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:32:26.030330 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:32:26.030856 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:32:26.031073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b7fb42c-6683-401d-8038-efe476bbe79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c5220>]}
[0m19:32:26.743546 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_copernicus_eu_raw_observations_humidity__100__0 (models/copernicus_eu_raw_observations.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'min_value'
[0m19:32:26.745122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7669562, "process_in_blocks": "0", "process_kernel_time": 0.418816, "process_mem_max_rss": "125583360", "process_out_blocks": "0", "process_user_time": 2.344692}
[0m19:32:26.745367 [debug] [MainThread]: Command `dbt run` failed at 19:32:26.745314 after 1.77 seconds
[0m19:32:26.745593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104532d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104451f40>]}
[0m19:32:26.745807 [debug] [MainThread]: Flushing usage events
[0m19:32:26.899877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:17.883018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104054100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104054fd0>]}


============================== 19:33:17.885654 | 2163fd27-baba-49d3-9598-961e31974800 ==============================
[0m19:33:17.885654 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:33:17.885987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ericliao/climate_elt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:18.007574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2163fd27-baba-49d3-9598-961e31974800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022717c0>]}
[0m19:33:18.038558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2163fd27-baba-49d3-9598-961e31974800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eade50>]}
[0m19:33:18.041540 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:33:18.110182 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:33:18.110649 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:33:18.110878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2163fd27-baba-49d3-9598-961e31974800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104216e20>]}
[0m19:33:18.758662 [error] [MainThread]: Encountered an error:
Compilation Error in test accepted_values_copernicus_eu_raw_observations_humidity__100__0 (models/copernicus_eu_raw_observations.yml)
  macro 'dbt_macro__test_accepted_values' takes no keyword argument 'min_value'
[0m19:33:18.759950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9233267, "process_in_blocks": "0", "process_kernel_time": 0.124912, "process_mem_max_rss": "107659264", "process_out_blocks": "0", "process_user_time": 1.473558}
[0m19:33:18.760191 [debug] [MainThread]: Command `dbt run` failed at 19:33:18.760137 after 0.92 seconds
[0m19:33:18.760406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d7550>]}
[0m19:33:18.760620 [debug] [MainThread]: Flushing usage events
[0m19:33:18.885332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:09.580811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b182b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8460>]}


============================== 19:40:09.583587 | e7ed506a-1a67-4809-85bb-1921f4868aa3 ==============================
[0m19:40:09.583587 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:40:09.583973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '/Users/ericliao/climate_elt/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:40:09.717184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bd50d0>]}
[0m19:40:09.748160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab6820>]}
[0m19:40:09.750255 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:40:09.819854 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:40:09.820329 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:40:09.820532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054980a0>]}
[0m19:40:10.507076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bbf10>]}
[0m19:40:10.556446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:40:10.559095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:40:10.596326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e43730>]}
[0m19:40:10.596664 [info ] [MainThread]: Found 1 model, 9 data tests, 424 macros
[0m19:40:10.596849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106171160>]}
[0m19:40:10.597616 [info ] [MainThread]: 
[0m19:40:10.597803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:10.597953 [info ] [MainThread]: 
[0m19:40:10.598268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:40:10.598739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m19:40:10.649028 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m19:40:10.649297 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m19:40:10.649459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:12.134704 [debug] [ThreadPool]: SQL status: OK in 1.485 seconds
[0m19:40:12.135895 [debug] [ThreadPool]: On list_database_name: Close
[0m19:40:12.137454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m19:40:12.137770 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m19:40:12.142161 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:40:12.142347 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m19:40:12.142518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:12.166482 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m19:40:12.167401 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:40:12.167573 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m19:40:12.167785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:40:12.167926 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:40:12.168067 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m19:40:12.168350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:40:12.168777 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m19:40:12.168924 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:40:12.169058 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m19:40:12.169261 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:40:12.169406 [debug] [ThreadPool]: On create_database_name_main: Close
[0m19:40:12.170648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m19:40:12.174310 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:40:12.174503 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m19:40:12.174645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:12.197179 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m19:40:12.197432 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:40:12.197597 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m19:40:12.206385 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:40:12.207131 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m19:40:12.208586 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m19:40:12.208753 [debug] [ThreadPool]: On list_database_name_main: Close
[0m19:40:12.209737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619c6a0>]}
[0m19:40:12.210041 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:12.210195 [debug] [MainThread]: On master: BEGIN
[0m19:40:12.210330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:12.233648 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m19:40:12.233973 [debug] [MainThread]: On master: COMMIT
[0m19:40:12.234140 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:12.234285 [debug] [MainThread]: On master: COMMIT
[0m19:40:12.234500 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:40:12.234662 [debug] [MainThread]: On master: Close
[0m19:40:12.235993 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:40:12.236398 [info ] [Thread-1  ]: 1 of 1 START sql table model main.copernicus_eu_raw_observations ............... [RUN]
[0m19:40:12.236702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.copernicus_eu_raw_observations)
[0m19:40:12.236897 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:40:12.242436 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:40:12.243118 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:40:12.264913 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:40:12.265527 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:40:12.265724 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: BEGIN
[0m19:40:12.265903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:40:12.290758 [debug] [Thread-1  ]: SQL status: OK in 0.025 seconds
[0m19:40:12.291068 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:40:12.291275 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.copernicus_eu_raw_observations"} */

  
    
    

    create  table
      "database_name"."main"."copernicus_eu_raw_observations__dbt_tmp"
  
    as (
      -- models/copernicus_eu_raw_observations.sql



with raw_data as (
    select
        cast("observation_id" as integer) as observation_id,
        cast("observation_time" as timestamp) as observation_time,
        cast("temperature" as double) as temperature,
        cast("humidity" as double) as humidity,
        cast("wind_speed" as double) as wind_speed,
        cast("precipitation" as double) as precipitation,
        "station_id" as station_id,
        "station_name" as station_name
    from read_csv_auto('data/COPERNICUS_EU_RAW_OBSERVATIONS.csv', header=True)
)

select * from raw_data;
    );
  
  
[0m19:40:12.294003 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.copernicus_eu_raw_observations"} */

  
    
    

    create  table
      "database_name"."main"."copernicus_eu_raw_observations__dbt_tmp"
  
    as (
      -- models/copernicus_eu_raw_observations.sql



with raw_data as (
    select
        cast("observation_id" as integer) as observation_id,
        cast("observation_time" as timestamp) as observation_time,
        cast("temperature" as double) as temperature,
        cast("humidity" as double) as humidity,
        cast("wind_speed" as double) as wind_speed,
        cast("precipitation" as double) as precipitation,
        "station_id" as station_id,
        "station_name" as station_name
    from read_csv_auto('data/COPERNICUS_EU_RAW_OBSERVATIONS.csv', header=True)
)

select * from raw_data;
    );
  
  
[0m19:40:12.294297 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m19:40:12.294568 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: ROLLBACK
[0m19:40:12.308770 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.copernicus_eu_raw_observations'
[0m19:40:12.309050 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: Close
[0m19:40:12.312723 [debug] [Thread-1  ]: Runtime Error in model copernicus_eu_raw_observations (models/copernicus_eu_raw_observations.sql)
  Parser Error: syntax error at or near ";"
[0m19:40:12.314340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ed506a-1a67-4809-85bb-1921f4868aa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d96a0>]}
[0m19:40:12.314754 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.copernicus_eu_raw_observations ...... [[31mERROR[0m in 0.08s]
[0m19:40:12.315076 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:40:12.315383 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.copernicus_eu_raw_observations' to be skipped because of status 'error'.  Reason: Runtime Error in model copernicus_eu_raw_observations (models/copernicus_eu_raw_observations.sql)
  Parser Error: syntax error at or near ";".
[0m19:40:12.316047 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:12.316252 [debug] [MainThread]: On master: BEGIN
[0m19:40:12.316409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:12.339151 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m19:40:12.339377 [debug] [MainThread]: On master: COMMIT
[0m19:40:12.339531 [debug] [MainThread]: Using duckdb connection "master"
[0m19:40:12.339667 [debug] [MainThread]: On master: COMMIT
[0m19:40:12.339853 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:40:12.340050 [debug] [MainThread]: On master: Close
[0m19:40:12.340898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:12.341145 [debug] [MainThread]: Connection 'model.weather_dbt_project.copernicus_eu_raw_observations' was properly closed.
[0m19:40:12.341313 [info ] [MainThread]: 
[0m19:40:12.341480 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m19:40:12.341845 [debug] [MainThread]: Command end result
[0m19:40:12.356043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:40:12.357102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:40:12.360967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m19:40:12.361145 [info ] [MainThread]: 
[0m19:40:12.361337 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:40:12.361498 [info ] [MainThread]: 
[0m19:40:12.361681 [error] [MainThread]:   Runtime Error in model copernicus_eu_raw_observations (models/copernicus_eu_raw_observations.sql)
  Parser Error: syntax error at or near ";"
[0m19:40:12.361826 [info ] [MainThread]: 
[0m19:40:12.361981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:40:12.362897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.828104, "process_in_blocks": "0", "process_kernel_time": 0.366245, "process_mem_max_rss": "261013504", "process_out_blocks": "0", "process_user_time": 2.618015}
[0m19:40:12.363096 [debug] [MainThread]: Command `dbt run` failed at 19:40:12.363054 after 2.83 seconds
[0m19:40:12.363287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b182b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e43730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca8910>]}
[0m19:40:12.363484 [debug] [MainThread]: Flushing usage events
[0m19:40:12.617756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:41:52.840672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b95100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b95f70>]}


============================== 19:41:52.843383 | 7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d ==============================
[0m19:41:52.843383 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:41:52.843699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:52.974994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb1580>]}
[0m19:41:53.005710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5ab20>]}
[0m19:41:53.008326 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:41:53.077490 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:41:53.157809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:53.158188 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/copernicus_eu_raw_observations.sql
[0m19:41:53.384298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104416f10>]}
[0m19:41:53.433160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:41:53.436251 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:41:53.445780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b0c10>]}
[0m19:41:53.446093 [info ] [MainThread]: Found 1 model, 9 data tests, 424 macros
[0m19:41:53.446297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b32e0>]}
[0m19:41:53.447136 [info ] [MainThread]: 
[0m19:41:53.447329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:53.447483 [info ] [MainThread]: 
[0m19:41:53.447771 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:41:53.448249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m19:41:53.506420 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m19:41:53.506684 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m19:41:53.506867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:53.556067 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m19:41:53.556960 [debug] [ThreadPool]: On list_database_name: Close
[0m19:41:53.558049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m19:41:53.558347 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m19:41:53.562691 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:41:53.562886 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m19:41:53.563045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:53.586325 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:41:53.587181 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:41:53.587354 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m19:41:53.587558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:53.587704 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:41:53.587849 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m19:41:53.588105 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:53.588528 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m19:41:53.588677 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m19:41:53.588812 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m19:41:53.588988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:41:53.589137 [debug] [ThreadPool]: On create_database_name_main: Close
[0m19:41:53.590249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m19:41:53.594044 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:41:53.594230 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m19:41:53.594375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:53.617323 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m19:41:53.617570 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:41:53.617734 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m19:41:53.625007 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m19:41:53.625705 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m19:41:53.627048 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m19:41:53.627210 [debug] [ThreadPool]: On list_database_name_main: Close
[0m19:41:53.628190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c5100>]}
[0m19:41:53.628472 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:53.628645 [debug] [MainThread]: On master: BEGIN
[0m19:41:53.628784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:53.651171 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m19:41:53.651400 [debug] [MainThread]: On master: COMMIT
[0m19:41:53.651549 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:53.651686 [debug] [MainThread]: On master: COMMIT
[0m19:41:53.651861 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:41:53.652008 [debug] [MainThread]: On master: Close
[0m19:41:53.653314 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:41:53.653614 [info ] [Thread-1  ]: 1 of 1 START sql table model main.copernicus_eu_raw_observations ............... [RUN]
[0m19:41:53.653887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.copernicus_eu_raw_observations)
[0m19:41:53.654073 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:41:53.658994 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.659433 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:41:53.681036 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.681455 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.681672 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: BEGIN
[0m19:41:53.681846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:41:53.706925 [debug] [Thread-1  ]: SQL status: OK in 0.025 seconds
[0m19:41:53.707265 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.707475 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.copernicus_eu_raw_observations"} */

  
    
    

    create  table
      "database_name"."main"."copernicus_eu_raw_observations__dbt_tmp"
  
    as (
      -- models/copernicus_eu_raw_observations.sql



with raw_data as (
    select
        cast("observation_id" as integer) as observation_id,
        cast("observation_time" as timestamp) as observation_time,
        cast("temperature" as double) as temperature,
        cast("humidity" as double) as humidity,
        cast("wind_speed" as double) as wind_speed,
        cast("precipitation" as double) as precipitation,
        "station_id" as station_id,
        "station_name" as station_name
    from read_csv_auto('data/COPERNICUS_EU_RAW_OBSERVATIONS.csv', header=True)
)

select * from raw_data
    );
  
  
[0m19:41:53.713266 [debug] [Thread-1  ]: SQL status: OK in 0.006 seconds
[0m19:41:53.717410 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.717638 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.copernicus_eu_raw_observations"} */
alter table "database_name"."main"."copernicus_eu_raw_observations__dbt_tmp" rename to "copernicus_eu_raw_observations"
[0m19:41:53.718219 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:41:53.725734 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: COMMIT
[0m19:41:53.725943 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.726126 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: COMMIT
[0m19:41:53.726937 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m19:41:53.729822 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.copernicus_eu_raw_observations"
[0m19:41:53.730026 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.copernicus_eu_raw_observations"} */
drop table if exists "database_name"."main"."copernicus_eu_raw_observations__dbt_backup" cascade
[0m19:41:53.730293 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:41:53.731729 [debug] [Thread-1  ]: On model.weather_dbt_project.copernicus_eu_raw_observations: Close
[0m19:41:53.736014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a05cde0-2bf2-40f5-a0d1-0ff2ea74788d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104215640>]}
[0m19:41:53.736433 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.copernicus_eu_raw_observations .......... [[32mOK[0m in 0.08s]
[0m19:41:53.736745 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.copernicus_eu_raw_observations
[0m19:41:53.737378 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:53.737537 [debug] [MainThread]: On master: BEGIN
[0m19:41:53.737675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:53.760004 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m19:41:53.760241 [debug] [MainThread]: On master: COMMIT
[0m19:41:53.760390 [debug] [MainThread]: Using duckdb connection "master"
[0m19:41:53.760527 [debug] [MainThread]: On master: COMMIT
[0m19:41:53.760701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:41:53.760857 [debug] [MainThread]: On master: Close
[0m19:41:53.761567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:53.761724 [debug] [MainThread]: Connection 'model.weather_dbt_project.copernicus_eu_raw_observations' was properly closed.
[0m19:41:53.761895 [info ] [MainThread]: 
[0m19:41:53.762058 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m19:41:53.762407 [debug] [MainThread]: Command end result
[0m19:41:53.776458 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:41:53.777301 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:41:53.781116 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m19:41:53.781331 [info ] [MainThread]: 
[0m19:41:53.781544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:53.781695 [info ] [MainThread]: 
[0m19:41:53.781857 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:41:53.782830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.98830277, "process_in_blocks": "0", "process_kernel_time": 0.221412, "process_mem_max_rss": "146833408", "process_out_blocks": "0", "process_user_time": 2.075563}
[0m19:41:53.783044 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:53.782998 after 0.99 seconds
[0m19:41:53.783245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e566d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d844f0>]}
[0m19:41:53.783446 [debug] [MainThread]: Flushing usage events
[0m19:41:53.878986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:56.394677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064790d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106479400>]}


============================== 19:45:56.397828 | 5101809d-d932-416c-a45a-eb89f27e01ff ==============================
[0m19:45:56.397828 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:45:56.398155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ericliao/climate_elt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:45:56.534383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655f130>]}
[0m19:45:56.565385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644e790>]}
[0m19:45:56.567408 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:45:56.637449 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:45:56.720695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:56.720917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:56.746810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d0130>]}
[0m19:45:56.795084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:45:56.796186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:45:56.871801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be5fa0>]}
[0m19:45:56.872145 [info ] [MainThread]: Found 1 model, 9 data tests, 424 macros
[0m19:45:56.872341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be51c0>]}
[0m19:45:56.873311 [info ] [MainThread]: 
[0m19:45:56.873506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:56.873660 [info ] [MainThread]: 
[0m19:45:56.873936 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:45:56.874424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name_main'
[0m19:45:56.913479 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:45:56.913738 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m19:45:56.913884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:57.015258 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m19:45:57.015554 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m19:45:57.015717 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m19:45:57.035817 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m19:45:57.037079 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m19:45:57.038383 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m19:45:57.038549 [debug] [ThreadPool]: On list_database_name_main: Close
[0m19:45:57.040132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5101809d-d932-416c-a45a-eb89f27e01ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dad100>]}
[0m19:45:57.040411 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:57.040556 [debug] [MainThread]: On master: BEGIN
[0m19:45:57.040688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:57.063813 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m19:45:57.064072 [debug] [MainThread]: On master: COMMIT
[0m19:45:57.064231 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:57.064368 [debug] [MainThread]: On master: COMMIT
[0m19:45:57.064556 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:57.064711 [debug] [MainThread]: On master: Close
[0m19:45:57.066010 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178
[0m19:45:57.066246 [info ] [Thread-1  ]: 1 of 9 START test not_null_copernicus_eu_raw_observations_humidity ............. [RUN]
[0m19:45:57.066633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178)
[0m19:45:57.066834 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178
[0m19:45:57.076661 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178"
[0m19:45:57.077183 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178
[0m19:45:57.085605 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178"
[0m19:45:57.086031 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178"
[0m19:45:57.086217 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178: BEGIN
[0m19:45:57.086382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.109640 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.109910 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178"
[0m19:45:57.110098 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select humidity
from "database_name"."main"."copernicus_eu_raw_observations"
where humidity is null



      
    ) dbt_internal_test
[0m19:45:57.113462 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m19:45:57.116027 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178: ROLLBACK
[0m19:45:57.116296 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178'
[0m19:45:57.116474 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178: Close
[0m19:45:57.117367 [error] [Thread-1  ]: 1 of 9 FAIL 1 not_null_copernicus_eu_raw_observations_humidity ................. [[31mFAIL 1[0m in 0.05s]
[0m19:45:57.117689 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178
[0m19:45:57.117902 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381
[0m19:45:57.118127 [info ] [Thread-1  ]: 2 of 9 START test not_null_copernicus_eu_raw_observations_observation_id ....... [RUN]
[0m19:45:57.118347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_humidity.65c7457178, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381)
[0m19:45:57.118538 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381
[0m19:45:57.121084 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381"
[0m19:45:57.121497 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381
[0m19:45:57.122910 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381"
[0m19:45:57.123257 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381"
[0m19:45:57.123437 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381: BEGIN
[0m19:45:57.123610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.146965 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.147259 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381"
[0m19:45:57.147459 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select observation_id
from "database_name"."main"."copernicus_eu_raw_observations"
where observation_id is null



      
    ) dbt_internal_test
[0m19:45:57.148047 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.149176 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381: ROLLBACK
[0m19:45:57.149472 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381'
[0m19:45:57.149658 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381: Close
[0m19:45:57.150562 [info ] [Thread-1  ]: 2 of 9 PASS not_null_copernicus_eu_raw_observations_observation_id ............. [[32mPASS[0m in 0.03s]
[0m19:45:57.150883 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381
[0m19:45:57.151092 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318
[0m19:45:57.151300 [info ] [Thread-1  ]: 3 of 9 START test not_null_copernicus_eu_raw_observations_observation_time ..... [RUN]
[0m19:45:57.151538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_id.45bb369381, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318)
[0m19:45:57.151724 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318
[0m19:45:57.154407 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318"
[0m19:45:57.154869 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318
[0m19:45:57.157346 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318"
[0m19:45:57.157813 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318"
[0m19:45:57.158010 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318: BEGIN
[0m19:45:57.158185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.182880 [debug] [Thread-1  ]: SQL status: OK in 0.025 seconds
[0m19:45:57.183156 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318"
[0m19:45:57.183344 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select observation_time
from "database_name"."main"."copernicus_eu_raw_observations"
where observation_time is null



      
    ) dbt_internal_test
[0m19:45:57.183776 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.184661 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318: ROLLBACK
[0m19:45:57.184917 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318'
[0m19:45:57.185092 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318: Close
[0m19:45:57.186110 [info ] [Thread-1  ]: 3 of 9 PASS not_null_copernicus_eu_raw_observations_observation_time ........... [[32mPASS[0m in 0.03s]
[0m19:45:57.186497 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318
[0m19:45:57.186741 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2
[0m19:45:57.186941 [info ] [Thread-1  ]: 4 of 9 START test not_null_copernicus_eu_raw_observations_precipitation ........ [RUN]
[0m19:45:57.187181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_observation_time.a3aaed5318, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2)
[0m19:45:57.187369 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2
[0m19:45:57.190005 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2"
[0m19:45:57.190527 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2
[0m19:45:57.192026 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2"
[0m19:45:57.192394 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2"
[0m19:45:57.192573 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2: BEGIN
[0m19:45:57.192738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.216439 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m19:45:57.216718 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2"
[0m19:45:57.216908 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select precipitation
from "database_name"."main"."copernicus_eu_raw_observations"
where precipitation is null



      
    ) dbt_internal_test
[0m19:45:57.217362 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.218288 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2: ROLLBACK
[0m19:45:57.218576 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2'
[0m19:45:57.218767 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2: Close
[0m19:45:57.219638 [info ] [Thread-1  ]: 4 of 9 PASS not_null_copernicus_eu_raw_observations_precipitation .............. [[32mPASS[0m in 0.03s]
[0m19:45:57.219940 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2
[0m19:45:57.220141 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407
[0m19:45:57.220321 [info ] [Thread-1  ]: 5 of 9 START test not_null_copernicus_eu_raw_observations_station_id ........... [RUN]
[0m19:45:57.220588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_precipitation.c0161ee5c2, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407)
[0m19:45:57.220796 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407
[0m19:45:57.223445 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407"
[0m19:45:57.223943 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407
[0m19:45:57.225819 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407"
[0m19:45:57.226295 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407"
[0m19:45:57.226488 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407: BEGIN
[0m19:45:57.226652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.249749 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.250023 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407"
[0m19:45:57.250232 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select station_id
from "database_name"."main"."copernicus_eu_raw_observations"
where station_id is null



      
    ) dbt_internal_test
[0m19:45:57.250766 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.251787 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407: ROLLBACK
[0m19:45:57.252052 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407'
[0m19:45:57.252226 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407: Close
[0m19:45:57.253137 [info ] [Thread-1  ]: 5 of 9 PASS not_null_copernicus_eu_raw_observations_station_id ................. [[32mPASS[0m in 0.03s]
[0m19:45:57.253474 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407
[0m19:45:57.253686 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7
[0m19:45:57.253878 [info ] [Thread-1  ]: 6 of 9 START test not_null_copernicus_eu_raw_observations_station_name ......... [RUN]
[0m19:45:57.254141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_id.45a7028407, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7)
[0m19:45:57.254344 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7
[0m19:45:57.256946 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7"
[0m19:45:57.257426 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7
[0m19:45:57.258817 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7"
[0m19:45:57.259175 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7"
[0m19:45:57.259356 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7: BEGIN
[0m19:45:57.259519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.282094 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.282354 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7"
[0m19:45:57.282540 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select station_name
from "database_name"."main"."copernicus_eu_raw_observations"
where station_name is null



      
    ) dbt_internal_test
[0m19:45:57.283069 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.283946 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7: ROLLBACK
[0m19:45:57.284206 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7'
[0m19:45:57.284395 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7: Close
[0m19:45:57.285322 [info ] [Thread-1  ]: 6 of 9 PASS not_null_copernicus_eu_raw_observations_station_name ............... [[32mPASS[0m in 0.03s]
[0m19:45:57.285620 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7
[0m19:45:57.285820 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6
[0m19:45:57.286002 [info ] [Thread-1  ]: 7 of 9 START test not_null_copernicus_eu_raw_observations_temperature .......... [RUN]
[0m19:45:57.286227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_station_name.ba4fb24ad7, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6)
[0m19:45:57.286409 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6
[0m19:45:57.288886 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6"
[0m19:45:57.289435 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6
[0m19:45:57.317850 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6"
[0m19:45:57.318476 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6"
[0m19:45:57.318670 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6: BEGIN
[0m19:45:57.318845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.342368 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.342657 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6"
[0m19:45:57.342853 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temperature
from "database_name"."main"."copernicus_eu_raw_observations"
where temperature is null



      
    ) dbt_internal_test
[0m19:45:57.343401 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.344410 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6: ROLLBACK
[0m19:45:57.344678 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6'
[0m19:45:57.344852 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6: Close
[0m19:45:57.345866 [info ] [Thread-1  ]: 7 of 9 PASS not_null_copernicus_eu_raw_observations_temperature ................ [[32mPASS[0m in 0.06s]
[0m19:45:57.346232 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6
[0m19:45:57.346435 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc
[0m19:45:57.346624 [info ] [Thread-1  ]: 8 of 9 START test not_null_copernicus_eu_raw_observations_wind_speed ........... [RUN]
[0m19:45:57.346915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_temperature.c95a6275e6, now test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc)
[0m19:45:57.347107 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc
[0m19:45:57.349827 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc"
[0m19:45:57.350282 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc
[0m19:45:57.351762 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc"
[0m19:45:57.352155 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc"
[0m19:45:57.352337 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc: BEGIN
[0m19:45:57.352503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.375510 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.375779 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc"
[0m19:45:57.375964 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select wind_speed
from "database_name"."main"."copernicus_eu_raw_observations"
where wind_speed is null



      
    ) dbt_internal_test
[0m19:45:57.376428 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m19:45:57.377400 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc: ROLLBACK
[0m19:45:57.377654 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc'
[0m19:45:57.377828 [debug] [Thread-1  ]: On test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc: Close
[0m19:45:57.378751 [info ] [Thread-1  ]: 8 of 9 PASS not_null_copernicus_eu_raw_observations_wind_speed ................. [[32mPASS[0m in 0.03s]
[0m19:45:57.379057 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc
[0m19:45:57.379255 [debug] [Thread-1  ]: Began running node test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7
[0m19:45:57.379439 [info ] [Thread-1  ]: 9 of 9 START test unique_copernicus_eu_raw_observations_observation_id ......... [RUN]
[0m19:45:57.379671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.weather_dbt_project.not_null_copernicus_eu_raw_observations_wind_speed.4544c729bc, now test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7)
[0m19:45:57.379855 [debug] [Thread-1  ]: Began compiling node test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7
[0m19:45:57.383904 [debug] [Thread-1  ]: Writing injected SQL for node "test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7"
[0m19:45:57.384482 [debug] [Thread-1  ]: Began executing node test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7
[0m19:45:57.386303 [debug] [Thread-1  ]: Writing runtime sql for node "test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7"
[0m19:45:57.386812 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7"
[0m19:45:57.386994 [debug] [Thread-1  ]: On test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7: BEGIN
[0m19:45:57.387159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:45:57.410184 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m19:45:57.410462 [debug] [Thread-1  ]: Using duckdb connection "test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7"
[0m19:45:57.410653 [debug] [Thread-1  ]: On test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    observation_id as unique_field,
    count(*) as n_records

from "database_name"."main"."copernicus_eu_raw_observations"
where observation_id is not null
group by observation_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:45:57.413332 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m19:45:57.414269 [debug] [Thread-1  ]: On test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7: ROLLBACK
[0m19:45:57.414521 [debug] [Thread-1  ]: Failed to rollback 'test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7'
[0m19:45:57.414697 [debug] [Thread-1  ]: On test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7: Close
[0m19:45:57.415575 [info ] [Thread-1  ]: 9 of 9 PASS unique_copernicus_eu_raw_observations_observation_id ............... [[32mPASS[0m in 0.04s]
[0m19:45:57.415880 [debug] [Thread-1  ]: Finished running node test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7
[0m19:45:57.416460 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:57.416635 [debug] [MainThread]: On master: BEGIN
[0m19:45:57.416773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:57.439270 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m19:45:57.439524 [debug] [MainThread]: On master: COMMIT
[0m19:45:57.439678 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:57.439814 [debug] [MainThread]: On master: COMMIT
[0m19:45:57.439987 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:57.440132 [debug] [MainThread]: On master: Close
[0m19:45:57.440867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:57.441011 [debug] [MainThread]: Connection 'test.weather_dbt_project.unique_copernicus_eu_raw_observations_observation_id.0776bf5ab7' was properly closed.
[0m19:45:57.441182 [info ] [MainThread]: 
[0m19:45:57.441343 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m19:45:57.442203 [debug] [MainThread]: Command end result
[0m19:45:57.456296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m19:45:57.457166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m19:45:57.461505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m19:45:57.461677 [info ] [MainThread]: 
[0m19:45:57.461861 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:45:57.462017 [info ] [MainThread]: 
[0m19:45:57.462204 [error] [MainThread]: [31mFailure in test not_null_copernicus_eu_raw_observations_humidity (models/copernicus_eu_raw_observations.yml)[0m
[0m19:45:57.462381 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:45:57.462513 [info ] [MainThread]: 
[0m19:45:57.462680 [info ] [MainThread]:   compiled code at target/compiled/weather_dbt_project/models/copernicus_eu_raw_observations.yml/not_null_copernicus_eu_raw_observations_humidity.sql
[0m19:45:57.462828 [info ] [MainThread]: 
[0m19:45:57.462982 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:45:57.463914 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1174698, "process_in_blocks": "0", "process_kernel_time": 0.409111, "process_mem_max_rss": "160415744", "process_out_blocks": "0", "process_user_time": 2.663094}
[0m19:45:57.464118 [debug] [MainThread]: Command `dbt test` failed at 19:45:57.464076 after 1.12 seconds
[0m19:45:57.464314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc8d90>]}
[0m19:45:57.464503 [debug] [MainThread]: Flushing usage events
[0m19:45:57.683826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:55.777814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c00250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a92ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a92b80>]}


============================== 20:41:55.781167 | 2077ba5a-6ec0-4fb0-9926-89809c6038ba ==============================
[0m20:41:55.781167 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:41:55.781499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '../', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ../', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:55.917260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2077ba5a-6ec0-4fb0-9926-89809c6038ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cbd7c0>]}
[0m20:41:55.951009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2077ba5a-6ec0-4fb0-9926-89809c6038ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557f3d0>]}
[0m20:41:55.953497 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:41:56.024075 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:41:56.108033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:41:56.108415 [debug] [MainThread]: Partial parsing: added file: weather_dbt_project://models/open_meteo_raw_data.yml
[0m20:41:56.108603 [debug] [MainThread]: Partial parsing: added file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:41:56.353214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2077ba5a-6ec0-4fb0-9926-89809c6038ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106307130>]}
[0m20:41:56.402794 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:41:56.404054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:41:56.416396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2077ba5a-6ec0-4fb0-9926-89809c6038ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa0e20>]}
[0m20:41:56.416684 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:41:56.416881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2077ba5a-6ec0-4fb0-9926-89809c6038ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106316e80>]}
[0m20:41:56.417670 [info ] [MainThread]: 
[0m20:41:56.417860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:56.418012 [info ] [MainThread]: 
[0m20:41:56.418276 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:56.418723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:41:56.486110 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:41:56.486383 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:41:56.486541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:56.515801 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:41:56.516030 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:41:56.516480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:56.516631 [debug] [MainThread]: Connection 'list_database_name' was properly closed.
[0m20:41:56.516785 [info ] [MainThread]: 
[0m20:41:56.516959 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m20:41:56.517237 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/ericliao/climate_elt/dbt/models/duck_db_files/database_name.duckdb": No such file or directory
[0m20:41:56.518508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7881778, "process_in_blocks": "0", "process_kernel_time": 0.181684, "process_mem_max_rss": "120750080", "process_out_blocks": "0", "process_user_time": 1.248241}
[0m20:41:56.518791 [debug] [MainThread]: Command `dbt run` failed at 20:41:56.518738 after 0.79 seconds
[0m20:41:56.519003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c00250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627d040>]}
[0m20:41:56.519216 [debug] [MainThread]: Flushing usage events
[0m20:41:56.718375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:42:37.099684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ac280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103840f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103840be0>]}


============================== 20:42:37.102333 | b1aeb30c-2fd4-4780-bf57-e631419ce70b ==============================
[0m20:42:37.102333 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:42:37.102661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '../', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ../', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:42:37.104387 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_beginner_profile'
[0m20:42:37.105449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.051206917, "process_in_blocks": "0", "process_kernel_time": 0.078691, "process_mem_max_rss": "87277568", "process_out_blocks": "0", "process_user_time": 0.658085}
[0m20:42:37.105695 [debug] [MainThread]: Command `dbt run` failed at 20:42:37.105637 after 0.05 seconds
[0m20:42:37.105878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029ac280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037fba60>]}
[0m20:42:37.106063 [debug] [MainThread]: Flushing usage events
[0m20:42:37.217865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:43:07.484620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0ac40>]}


============================== 20:43:07.487396 | cc69b820-3f9e-44e8-8436-50bf52e7a937 ==============================
[0m20:43:07.487396 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:43:07.487826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': './', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:07.620620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c36ac0>]}
[0m20:43:07.651609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abafa0>]}
[0m20:43:07.653583 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:43:07.729615 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:43:07.813932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:43:07.814177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:43:07.840778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa2130>]}
[0m20:43:07.892022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:43:07.893084 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:43:07.904057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6790>]}
[0m20:43:07.904345 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:43:07.904537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc8940>]}
[0m20:43:07.905322 [info ] [MainThread]: 
[0m20:43:07.905524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:07.905675 [info ] [MainThread]: 
[0m20:43:07.905936 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:43:07.906368 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:43:07.939188 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:43:07.939435 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:43:07.939602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:08.030923 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m20:43:08.032031 [debug] [ThreadPool]: On list_database_name: Close
[0m20:43:08.033535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:43:08.033832 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:43:08.038064 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:43:08.038250 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:43:08.038401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:08.062664 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:43:08.063946 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:43:08.064202 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:43:08.064457 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:43:08.064606 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:43:08.064759 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:43:08.065420 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:43:08.065900 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:43:08.066065 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:43:08.066210 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:43:08.066403 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:43:08.066559 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:43:08.070394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:43:08.074200 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:43:08.074416 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:43:08.074572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:08.097393 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:43:08.097675 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:43:08.097846 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:43:08.108104 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:43:08.108974 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:43:08.110332 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:43:08.110499 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:43:08.111587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b0940>]}
[0m20:43:08.111868 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:08.112020 [debug] [MainThread]: On master: BEGIN
[0m20:43:08.112157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:08.135403 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:43:08.135673 [debug] [MainThread]: On master: COMMIT
[0m20:43:08.135837 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:08.136014 [debug] [MainThread]: On master: COMMIT
[0m20:43:08.136206 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:43:08.136356 [debug] [MainThread]: On master: Close
[0m20:43:08.137701 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:43:08.138089 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:43:08.138357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:43:08.138555 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:43:08.144440 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:08.145135 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:43:08.159891 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:08.160106 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:43:08.160281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:43:08.183413 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:43:08.183755 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:08.184019 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:43:08.895030 [debug] [Thread-1  ]: SQL status: OK in 0.711 seconds
[0m20:43:08.896120 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:08.896403 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:43:09.157553 [debug] [Thread-1  ]: SQL status: OK in 0.261 seconds
[0m20:43:09.158561 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:09.158778 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:43:09.159151 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:43:09.160076 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:09.160639 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:43:09.161303 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:43:09.173079 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:09.173763 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:43:09.174024 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json',
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:43:09.176713 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json',
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:43:09.177028 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:43:09.177311 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m20:43:09.195791 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m20:43:09.196031 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:43:09.201524 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:43:09.203387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc69b820-3f9e-44e8-8436-50bf52e7a937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf1c10>]}
[0m20:43:09.203949 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 1.06s]
[0m20:43:09.204371 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:43:09.204721 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ",".
[0m20:43:09.205513 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:09.205764 [debug] [MainThread]: On master: BEGIN
[0m20:43:09.205967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:09.231362 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m20:43:09.231613 [debug] [MainThread]: On master: COMMIT
[0m20:43:09.231773 [debug] [MainThread]: Using duckdb connection "master"
[0m20:43:09.231922 [debug] [MainThread]: On master: COMMIT
[0m20:43:09.232107 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:43:09.232262 [debug] [MainThread]: On master: Close
[0m20:43:09.233068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:09.233322 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:43:09.233515 [info ] [MainThread]: 
[0m20:43:09.233697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m20:43:09.234079 [debug] [MainThread]: Command end result
[0m20:43:09.251042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:43:09.252069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:43:09.256429 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:43:09.256679 [info ] [MainThread]: 
[0m20:43:09.256910 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:43:09.257082 [info ] [MainThread]: 
[0m20:43:09.257275 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:43:09.257430 [info ] [MainThread]: 
[0m20:43:09.257611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:43:09.258795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8183342, "process_in_blocks": "0", "process_kernel_time": 0.320536, "process_mem_max_rss": "172163072", "process_out_blocks": "0", "process_user_time": 1.961841}
[0m20:43:09.259020 [debug] [MainThread]: Command `dbt run` failed at 20:43:09.258974 after 1.82 seconds
[0m20:43:09.259239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b782e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc6280>]}
[0m20:43:09.259448 [debug] [MainThread]: Flushing usage events
[0m20:43:09.446307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:58.485013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103688280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451abe0>]}


============================== 20:44:58.487585 | 4df3822a-e26d-405e-aec1-ded90b4fbe85 ==============================
[0m20:44:58.487585 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:44:58.488008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:58.621356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f64f0>]}
[0m20:44:58.652501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff19d0>]}
[0m20:44:58.654446 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:44:58.723913 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:44:58.805651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:58.806078 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:44:59.048077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dba130>]}
[0m20:44:59.097885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:44:59.099789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:44:59.111732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9dbe0>]}
[0m20:44:59.112107 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:44:59.112313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0fbe0>]}
[0m20:44:59.113185 [info ] [MainThread]: 
[0m20:44:59.113427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:59.113748 [info ] [MainThread]: 
[0m20:44:59.114112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:44:59.114594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:44:59.174001 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:44:59.174253 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:44:59.174413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:59.210031 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m20:44:59.210868 [debug] [ThreadPool]: On list_database_name: Close
[0m20:44:59.211835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:44:59.212130 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:44:59.216283 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:44:59.216469 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:44:59.216621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:59.240276 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:44:59.241123 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:44:59.241296 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:44:59.241499 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:44:59.241650 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:44:59.241807 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:44:59.242020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:44:59.242439 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:44:59.242591 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:44:59.242727 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:44:59.242905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:44:59.243049 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:44:59.246695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:44:59.250057 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:44:59.250241 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:44:59.250417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:59.273305 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:44:59.273587 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:44:59.273753 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:44:59.279950 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:44:59.280712 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:44:59.282967 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:44:59.283204 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:44:59.284365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d98190>]}
[0m20:44:59.284661 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:59.284812 [debug] [MainThread]: On master: BEGIN
[0m20:44:59.284948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:59.307659 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:44:59.307884 [debug] [MainThread]: On master: COMMIT
[0m20:44:59.308035 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:59.308169 [debug] [MainThread]: On master: COMMIT
[0m20:44:59.308341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:44:59.308481 [debug] [MainThread]: On master: Close
[0m20:44:59.309632 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:44:59.309918 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:44:59.310166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:44:59.310347 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:44:59.315382 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.315785 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:44:59.330925 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.331143 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:44:59.331315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:44:59.354557 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:44:59.354842 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.355025 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:44:59.355597 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:44:59.356362 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.356572 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:44:59.375206 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m20:44:59.380813 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.381373 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:44:59.381639 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json',
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:44:59.382192 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json',
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:44:59.382421 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:44:59.382660 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m20:44:59.396740 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m20:44:59.396951 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:44:59.400493 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:44:59.401722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df3822a-e26d-405e-aec1-ded90b4fbe85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a17f0>]}
[0m20:44:59.402110 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.09s]
[0m20:44:59.402428 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:44:59.402720 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ",".
[0m20:44:59.403376 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:59.403538 [debug] [MainThread]: On master: BEGIN
[0m20:44:59.403676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:59.425750 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m20:44:59.426022 [debug] [MainThread]: On master: COMMIT
[0m20:44:59.426185 [debug] [MainThread]: Using duckdb connection "master"
[0m20:44:59.426331 [debug] [MainThread]: On master: COMMIT
[0m20:44:59.426520 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:44:59.426674 [debug] [MainThread]: On master: Close
[0m20:44:59.427559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:59.427806 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:44:59.427987 [info ] [MainThread]: 
[0m20:44:59.428173 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:44:59.428544 [debug] [MainThread]: Command end result
[0m20:44:59.444812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:44:59.445771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:44:59.449695 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:44:59.449943 [info ] [MainThread]: 
[0m20:44:59.450160 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:44:59.450329 [info ] [MainThread]: 
[0m20:44:59.450526 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:44:59.450682 [info ] [MainThread]: 
[0m20:44:59.450852 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:44:59.452025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0112994, "process_in_blocks": "0", "process_kernel_time": 0.24183, "process_mem_max_rss": "143212544", "process_out_blocks": "0", "process_user_time": 2.128842}
[0m20:44:59.452236 [debug] [MainThread]: Command `dbt run` failed at 20:44:59.452191 after 1.01 seconds
[0m20:44:59.452445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103688280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d54ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaaee0>]}
[0m20:44:59.452654 [debug] [MainThread]: Flushing usage events
[0m20:44:59.715721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:20.238962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107524f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107524c40>]}


============================== 20:46:20.242362 | 1e9c26fd-d9b2-4d65-a0da-0b0987c90034 ==============================
[0m20:46:20.242362 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:46:20.242849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'send_anonymous_usage_stats': 'True'}
[0m20:46:20.389403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104389ac0>]}
[0m20:46:20.423400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d2fa0>]}
[0m20:46:20.426000 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:46:20.496562 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:46:20.584201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:20.584691 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:46:20.830053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc2130>]}
[0m20:46:20.878815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:46:20.879965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:46:20.892321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa5bb0>]}
[0m20:46:20.892616 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:46:20.892804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110117be0>]}
[0m20:46:20.893598 [info ] [MainThread]: 
[0m20:46:20.893788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:20.893935 [info ] [MainThread]: 
[0m20:46:20.894206 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:46:20.894668 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:46:20.963269 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:46:20.963549 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:46:20.963703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:21.055066 [debug] [ThreadPool]: SQL status: OK in 0.091 seconds
[0m20:46:21.055974 [debug] [ThreadPool]: On list_database_name: Close
[0m20:46:21.057469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:46:21.057768 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:46:21.061969 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:46:21.062156 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:46:21.062306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:21.086250 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:46:21.087309 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:46:21.087488 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:46:21.087695 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:21.087842 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:46:21.087981 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:46:21.088650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:46:21.089082 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:46:21.089232 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:46:21.089365 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:46:21.089551 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:46:21.089700 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:46:21.093290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:46:21.096720 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:46:21.096897 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:46:21.097037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:21.119938 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:46:21.120198 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:46:21.120364 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:46:21.129694 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:46:21.130469 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:46:21.131719 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:46:21.131876 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:46:21.132916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa0490>]}
[0m20:46:21.133186 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.133336 [debug] [MainThread]: On master: BEGIN
[0m20:46:21.133468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:21.157191 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:46:21.157467 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.157625 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.157763 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.157946 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:21.158097 [debug] [MainThread]: On master: Close
[0m20:46:21.159397 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:46:21.159785 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:46:21.160050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:46:21.160238 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:46:21.165350 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.165776 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:46:21.181054 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.181268 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:46:21.181441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:21.204421 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:46:21.204725 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.204910 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:46:21.205475 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:46:21.206231 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.206439 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:46:21.224676 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m20:46:21.230177 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.230619 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:46:21.230864 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:46:21.233945 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude'=35.23,
          'longitude'=-80.84,
          'start_date'='2025-01-22',
          'end_date'='2025-02-05',
          'hourly'='temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone'='America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:46:21.234285 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:46:21.234573 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m20:46:21.250133 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m20:46:21.250412 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:46:21.254138 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:46:21.255489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9c26fd-d9b2-4d65-a0da-0b0987c90034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785afd0>]}
[0m20:46:21.255940 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.09s]
[0m20:46:21.256265 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:46:21.256576 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ",".
[0m20:46:21.257204 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.257371 [debug] [MainThread]: On master: BEGIN
[0m20:46:21.257515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:21.283166 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m20:46:21.283423 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.283577 [debug] [MainThread]: Using duckdb connection "master"
[0m20:46:21.283714 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.283887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:46:21.284034 [debug] [MainThread]: On master: Close
[0m20:46:21.284786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:21.284935 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:46:21.285093 [info ] [MainThread]: 
[0m20:46:21.285251 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:46:21.285588 [debug] [MainThread]: Command end result
[0m20:46:21.301903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:46:21.302898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:46:21.306389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:46:21.306566 [info ] [MainThread]: 
[0m20:46:21.306782 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:46:21.306954 [info ] [MainThread]: 
[0m20:46:21.307146 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near ","
[0m20:46:21.307295 [info ] [MainThread]: 
[0m20:46:21.307464 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:46:21.308593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1227566, "process_in_blocks": "0", "process_kernel_time": 0.334201, "process_mem_max_rss": "145473536", "process_out_blocks": "0", "process_user_time": 2.116279}
[0m20:46:21.308827 [debug] [MainThread]: Command `dbt run` failed at 20:46:21.308777 after 1.12 seconds
[0m20:46:21.309044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f84fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107510970>]}
[0m20:46:21.309250 [debug] [MainThread]: Flushing usage events
[0m20:46:21.522762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:11.615384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108376f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108376c40>]}


============================== 20:50:11.618420 | 967e1a11-e9d6-42f6-bcc9-5c04da219909 ==============================
[0m20:50:11.618420 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:50:11.618857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:11.754139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a1ac0>]}
[0m20:50:11.785158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108427fa0>]}
[0m20:50:11.787107 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:50:11.857672 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:50:11.944348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:11.944791 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:50:12.192664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c14130>]}
[0m20:50:12.241463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:50:12.243781 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:50:12.255631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf9bb0>]}
[0m20:50:12.255932 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:50:12.256132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6bbe0>]}
[0m20:50:12.256929 [info ] [MainThread]: 
[0m20:50:12.257120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:50:12.257272 [info ] [MainThread]: 
[0m20:50:12.257547 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:12.257989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:50:12.324411 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:50:12.324692 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:50:12.324856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:12.426646 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m20:50:12.427721 [debug] [ThreadPool]: On list_database_name: Close
[0m20:50:12.429423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:50:12.429882 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:50:12.434300 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:50:12.434523 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:50:12.434693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:12.458877 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:50:12.459867 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:50:12.460040 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:50:12.460237 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:12.460388 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:50:12.460539 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:50:12.460953 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:12.461394 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:50:12.461544 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:50:12.461678 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:50:12.461864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:12.462020 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:50:12.465895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:50:12.469503 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:50:12.469686 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:50:12.469831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:12.493122 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:50:12.493405 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:50:12.493578 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:50:12.502696 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:50:12.503568 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:50:12.504890 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:50:12.505102 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:50:12.506228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf4490>]}
[0m20:50:12.506506 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:12.506662 [debug] [MainThread]: On master: BEGIN
[0m20:50:12.506799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:12.532706 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m20:50:12.532964 [debug] [MainThread]: On master: COMMIT
[0m20:50:12.533126 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:12.533272 [debug] [MainThread]: On master: COMMIT
[0m20:50:12.533451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:12.533601 [debug] [MainThread]: On master: Close
[0m20:50:12.534889 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:50:12.535225 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:50:12.535489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:50:12.535688 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:50:12.541029 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.541666 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:50:12.557844 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.558108 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:50:12.558282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:50:12.582042 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m20:50:12.582347 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.582537 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:50:12.583114 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:50:12.583907 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.584117 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:50:12.601823 [debug] [Thread-1  ]: SQL status: OK in 0.017 seconds
[0m20:50:12.607282 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.607743 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:12.607998 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
__response AS (
  SELECT
    (res->>'latitude')::float AS latitude,
    (res->>'longitude')::float AS longitude,
    (res->>'generationtime_ms')::float AS generationtime_ms,
    (res->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res->>'timezone')::string AS timezone,
    (res->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res->>'elevation')::int AS elevation,
    (res->>'hourly_units')::map(string, string) AS hourly_units,
    (res->>'hourly'->>'time')::date[] as time,
    (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    (res->>'hourly'->>'precipitation')::float[] as precipitation,
    (res->>'hourly'->>'rain')::float[] as rain,
    (res->>'hourly'->>'snowfall')::float[] as snowfall,
    (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    __input
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:50:14.138023 [debug] [Thread-1  ]: SQL status: OK in 1.530 seconds
[0m20:50:14.147649 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:14.148149 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:50:14.149613 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:50:14.163313 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:50:14.163805 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:14.164103 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:50:14.168510 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m20:50:14.173337 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:50:14.173678 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:50:14.174163 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:50:14.176091 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:50:14.181808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967e1a11-e9d6-42f6-bcc9-5c04da219909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108727910>]}
[0m20:50:14.182325 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 1.65s]
[0m20:50:14.182680 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:50:14.183407 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:14.183612 [debug] [MainThread]: On master: BEGIN
[0m20:50:14.183778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:14.208366 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m20:50:14.208641 [debug] [MainThread]: On master: COMMIT
[0m20:50:14.208811 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:14.208962 [debug] [MainThread]: On master: COMMIT
[0m20:50:14.209191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:14.209347 [debug] [MainThread]: On master: Close
[0m20:50:14.210144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:14.210318 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:50:14.210492 [info ] [MainThread]: 
[0m20:50:14.210668 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m20:50:14.211034 [debug] [MainThread]: Command end result
[0m20:50:14.228094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:50:14.229250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:50:14.232878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:50:14.233051 [info ] [MainThread]: 
[0m20:50:14.233273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:50:14.233432 [info ] [MainThread]: 
[0m20:50:14.233605 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:50:14.234792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6672077, "process_in_blocks": "0", "process_kernel_time": 0.349202, "process_mem_max_rss": "151519232", "process_out_blocks": "0", "process_user_time": 2.159726}
[0m20:50:14.235025 [debug] [MainThread]: Command `dbt run` succeeded at 20:50:14.234977 after 2.67 seconds
[0m20:50:14.235231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088456a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad8370>]}
[0m20:50:14.235431 [debug] [MainThread]: Flushing usage events
[0m20:50:14.404700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:14.616116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f18310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daabe0>]}


============================== 21:12:14.619120 | 44e25aac-c887-4b39-b170-d950f90ffa90 ==============================
[0m21:12:14.619120 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:12:14.619572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': './', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'send_anonymous_usage_stats': 'True'}
[0m21:12:14.756539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd51f0>]}
[0m21:12:14.787849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c22070>]}
[0m21:12:14.789841 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:12:14.860048 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:12:14.945612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:14.946045 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:12:15.188575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864a130>]}
[0m21:12:15.237436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:12:15.238642 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:12:15.250267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862dc10>]}
[0m21:12:15.250554 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m21:12:15.250753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869fc70>]}
[0m21:12:15.251558 [info ] [MainThread]: 
[0m21:12:15.251750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:15.251900 [info ] [MainThread]: 
[0m21:12:15.252170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:12:15.252629 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:12:15.317867 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:12:15.318123 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:12:15.318281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:15.414789 [debug] [ThreadPool]: SQL status: OK in 0.096 seconds
[0m21:12:15.415768 [debug] [ThreadPool]: On list_database_name: Close
[0m21:12:15.417681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:12:15.417977 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:12:15.422298 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:12:15.422497 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:12:15.422657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:15.446755 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:12:15.447881 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:12:15.448063 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:12:15.448297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:12:15.448440 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:12:15.448583 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:12:15.449357 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:12:15.449804 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:12:15.449953 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:12:15.450091 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:12:15.450278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:12:15.450429 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:12:15.454329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:12:15.457884 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:12:15.458067 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:12:15.458214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:15.482550 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:12:15.482823 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:12:15.482996 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:12:15.492662 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:12:15.493603 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:12:15.495002 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:12:15.495177 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:12:15.496492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108628070>]}
[0m21:12:15.496845 [debug] [MainThread]: Using duckdb connection "master"
[0m21:12:15.497026 [debug] [MainThread]: On master: BEGIN
[0m21:12:15.497184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:15.520315 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:12:15.520600 [debug] [MainThread]: On master: COMMIT
[0m21:12:15.520766 [debug] [MainThread]: Using duckdb connection "master"
[0m21:12:15.520913 [debug] [MainThread]: On master: COMMIT
[0m21:12:15.521097 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:12:15.521252 [debug] [MainThread]: On master: Close
[0m21:12:15.522661 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:12:15.523056 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:12:15.523339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:12:15.523537 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:12:15.528719 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.529141 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:12:15.544938 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.545290 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:12:15.545512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:12:15.574368 [debug] [Thread-1  ]: SQL status: OK in 0.029 seconds
[0m21:12:15.574930 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.575291 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:12:15.575853 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:12:15.576678 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.576884 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:12:15.590505 [debug] [Thread-1  ]: SQL status: OK in 0.013 seconds
[0m21:12:15.596035 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.596541 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:12:15.596811 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          -- 'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    from_json((res->>'body')::json,'{"latitude":"float", "longitude":"float", "generationtime_ms":"float", "utc_offset_seconds":"int", 
    "timezone":"string", "timezone_abbreviation":"string", "elevation":"int"}') as res2
  from
    __input
)
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation
    -- (res->>'hourly_units')::map(string, string) AS hourly_units,
    -- (res->>'hourly'->>'time')::date[] as time,
    -- (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    -- (res->>'hourly'->>'precipitation')::float[] as precipitation,
    -- (res->>'hourly'->>'rain')::float[] as rain,
    -- (res->>'hourly'->>'snowfall')::float[] as snowfall,
    -- (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    -- (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    -- (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    -- (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    -- (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    -- (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:12:15.599713 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          -- 'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    from_json((res->>'body')::json,'{"latitude":"float", "longitude":"float", "generationtime_ms":"float", "utc_offset_seconds":"int", 
    "timezone":"string", "timezone_abbreviation":"string", "elevation":"int"}') as res2
  from
    __input
)
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation
    -- (res->>'hourly_units')::map(string, string) AS hourly_units,
    -- (res->>'hourly'->>'time')::date[] as time,
    -- (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    -- (res->>'hourly'->>'precipitation')::float[] as precipitation,
    -- (res->>'hourly'->>'rain')::float[] as rain,
    -- (res->>'hourly'->>'snowfall')::float[] as snowfall,
    -- (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    -- (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    -- (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    -- (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    -- (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    -- (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:12:15.600022 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m21:12:15.600308 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m21:12:15.616156 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m21:12:15.616428 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:12:15.620198 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "__response"
[0m21:12:15.621515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44e25aac-c887-4b39-b170-d950f90ffa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0a3a0>]}
[0m21:12:15.621921 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.10s]
[0m21:12:15.622242 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:12:15.622555 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "__response".
[0m21:12:15.623195 [debug] [MainThread]: Using duckdb connection "master"
[0m21:12:15.623365 [debug] [MainThread]: On master: BEGIN
[0m21:12:15.623507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:12:15.646243 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:12:15.646541 [debug] [MainThread]: On master: COMMIT
[0m21:12:15.646701 [debug] [MainThread]: Using duckdb connection "master"
[0m21:12:15.646848 [debug] [MainThread]: On master: COMMIT
[0m21:12:15.647031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:12:15.647182 [debug] [MainThread]: On master: Close
[0m21:12:15.648062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:15.648295 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:12:15.648472 [info ] [MainThread]: 
[0m21:12:15.648653 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m21:12:15.649041 [debug] [MainThread]: Command end result
[0m21:12:15.665363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:12:15.666354 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:12:15.670187 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:12:15.670421 [info ] [MainThread]: 
[0m21:12:15.670650 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:12:15.670904 [info ] [MainThread]: 
[0m21:12:15.671139 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "__response"
[0m21:12:15.671316 [info ] [MainThread]: 
[0m21:12:15.671530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:12:15.672795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1033641, "process_in_blocks": "0", "process_kernel_time": 0.337501, "process_mem_max_rss": "143114240", "process_out_blocks": "0", "process_user_time": 2.136953}
[0m21:12:15.673027 [debug] [MainThread]: Command `dbt run` failed at 21:12:15.672977 after 1.10 seconds
[0m21:12:15.673239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f18310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107823b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709d850>]}
[0m21:12:15.673448 [debug] [MainThread]: Flushing usage events
[0m21:12:15.883306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:05.626940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c78f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c78bb0>]}


============================== 21:13:05.630458 | 6e63baba-8869-4306-8df1-43583430538b ==============================
[0m21:13:05.630458 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:13:05.631047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': './', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s open_meteo_raw_data --profiles-dir ./', 'send_anonymous_usage_stats': 'True'}
[0m21:13:05.775867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031608e0>]}
[0m21:13:05.810354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d4bbe0>]}
[0m21:13:05.813058 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:13:05.890120 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:13:05.974722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:13:05.975133 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:13:06.217440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104640130>]}
[0m21:13:06.266894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:13:06.269983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:13:06.280998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10400a0d0>]}
[0m21:13:06.281300 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m21:13:06.281498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464cf70>]}
[0m21:13:06.282292 [info ] [MainThread]: 
[0m21:13:06.282480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:06.282628 [info ] [MainThread]: 
[0m21:13:06.282905 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:13:06.283363 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:13:06.345308 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:13:06.345586 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:13:06.345742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:06.439434 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m21:13:06.440312 [debug] [ThreadPool]: On list_database_name: Close
[0m21:13:06.442051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:13:06.442342 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:13:06.446514 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:06.446706 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:13:06.446858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:06.469870 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:13:06.470878 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:06.471052 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:13:06.471254 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:06.471401 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:06.471541 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:13:06.471960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:06.472405 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:13:06.472558 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:06.472699 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:13:06.472884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:06.473037 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:13:06.476642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:13:06.480078 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:13:06.480257 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:13:06.480396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:06.503104 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:13:06.503339 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:13:06.503498 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:13:06.512663 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:13:06.513470 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:13:06.514681 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:13:06.514849 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:13:06.516197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd6760>]}
[0m21:13:06.516505 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:06.516663 [debug] [MainThread]: On master: BEGIN
[0m21:13:06.516797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:06.540745 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:13:06.541000 [debug] [MainThread]: On master: COMMIT
[0m21:13:06.541155 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:06.541297 [debug] [MainThread]: On master: COMMIT
[0m21:13:06.541475 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:06.541627 [debug] [MainThread]: On master: Close
[0m21:13:06.542897 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:06.543192 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:13:06.543441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:13:06.543627 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:06.548722 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.549162 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:06.564288 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.564513 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:13:06.564686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:06.595124 [debug] [Thread-1  ]: SQL status: OK in 0.030 seconds
[0m21:13:06.595560 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.595763 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:13:06.596276 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:06.597133 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.597329 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:13:06.607003 [debug] [Thread-1  ]: SQL status: OK in 0.009 seconds
[0m21:13:06.612810 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.613341 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:06.613602 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          -- 'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    from_json((res->>'body')::json,'{"latitude":"float", "longitude":"float", "generationtime_ms":"float", "utc_offset_seconds":"int", 
    "timezone":"string", "timezone_abbreviation":"string", "elevation":"int"}') as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation
    -- (res->>'hourly_units')::map(string, string) AS hourly_units,
    -- (res->>'hourly'->>'time')::date[] as time,
    -- (res->>'hourly'->>'temperature_2m')::float[] as temperature_2m,
    -- (res->>'hourly'->>'precipitation')::float[] as precipitation,
    -- (res->>'hourly'->>'rain')::float[] as rain,
    -- (res->>'hourly'->>'snowfall')::float[] as snowfall,
    -- (res->>'hourly'->>'surface_pressure')::float[] as surface_pressure,
    -- (res->>'hourly'->>'cloud_cover')::float[] as cloud_cover,
    -- (res->>'hourly'->>'evapotranspiration')::float[] as evapotranspiration,
    -- (res->>'hourly'->>'wind_speed_10m')::float[] as wind_speed_10m,
    -- (res->>'hourly'->>'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    -- (res->>'hourly'->>'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:13:07.547416 [debug] [Thread-1  ]: SQL status: OK in 0.933 seconds
[0m21:13:07.557326 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:07.557807 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:13:07.559289 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:13:07.562714 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:07.563081 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:13:07.563567 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:07.577189 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:13:07.577490 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:07.577742 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:13:07.579004 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:13:07.583083 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:07.583344 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:13:07.583969 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:07.585898 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:13:07.592096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e63baba-8869-4306-8df1-43583430538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff1b80>]}
[0m21:13:07.592601 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 1.05s]
[0m21:13:07.592978 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:07.593736 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:07.593943 [debug] [MainThread]: On master: BEGIN
[0m21:13:07.594115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:07.618265 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:13:07.618532 [debug] [MainThread]: On master: COMMIT
[0m21:13:07.618697 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:07.618847 [debug] [MainThread]: On master: COMMIT
[0m21:13:07.619040 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:07.619193 [debug] [MainThread]: On master: Close
[0m21:13:07.619995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:07.620157 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:13:07.620319 [info ] [MainThread]: 
[0m21:13:07.620486 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m21:13:07.620849 [debug] [MainThread]: Command end result
[0m21:13:07.637125 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:13:07.638250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:13:07.641749 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:13:07.641919 [info ] [MainThread]: 
[0m21:13:07.642144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:07.642305 [info ] [MainThread]: 
[0m21:13:07.642482 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:13:07.643682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0647547, "process_in_blocks": "0", "process_kernel_time": 0.356346, "process_mem_max_rss": "153763840", "process_out_blocks": "0", "process_user_time": 2.204012}
[0m21:13:07.643910 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:07.643863 after 2.07 seconds
[0m21:13:07.644128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f69370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f95190>]}
[0m21:13:07.644323 [debug] [MainThread]: Flushing usage events
[0m21:13:07.765512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:37.017797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035f81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448a040>]}


============================== 20:08:37.020721 | 213ca745-7c59-48b6-b7c6-62933c74f170 ==============================
[0m20:08:37.020721 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:08:37.021143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:08:37.165533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b5a00>]}
[0m20:08:37.196531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10374ec70>]}
[0m20:08:37.198503 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:08:37.275462 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:08:37.362118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:08:37.362538 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:08:37.606151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2b130>]}
[0m20:08:37.656003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:08:37.657197 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:08:37.668988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ecf70>]}
[0m20:08:37.669275 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:08:37.669469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f3700>]}
[0m20:08:37.670470 [info ] [MainThread]: 
[0m20:08:37.670665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:08:37.670814 [info ] [MainThread]: 
[0m20:08:37.671087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:08:37.671543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:08:37.738033 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:08:37.738272 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:08:37.738429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:37.824520 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m20:08:37.825601 [debug] [ThreadPool]: On list_database_name: Close
[0m20:08:37.827345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:08:37.827646 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:08:37.831778 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:08:37.831956 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:08:37.832108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:37.854306 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:08:37.855181 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:08:37.855360 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:08:37.855566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:37.855709 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:08:37.855850 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:08:37.856488 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:37.857143 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:08:37.857326 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:08:37.857469 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:08:37.857692 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:08:37.857844 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:08:37.861604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:08:37.865107 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:08:37.865285 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:08:37.865434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:08:37.888492 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:08:37.888714 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:08:37.888866 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:08:37.896705 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:08:37.897563 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:08:37.898833 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:08:37.899007 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:08:37.900229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0da60>]}
[0m20:08:37.900510 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:37.900676 [debug] [MainThread]: On master: BEGIN
[0m20:08:37.900810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:08:37.924983 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:08:37.925258 [debug] [MainThread]: On master: COMMIT
[0m20:08:37.925421 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:37.925564 [debug] [MainThread]: On master: COMMIT
[0m20:08:37.925753 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:37.925900 [debug] [MainThread]: On master: Close
[0m20:08:37.927289 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:08:37.927672 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:08:37.927950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:08:37.928139 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:08:37.933319 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:37.933759 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:08:37.949060 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:37.949285 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:08:37.949470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:08:37.972233 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:08:37.972502 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:37.972679 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:08:37.973283 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:08:37.974045 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:37.974244 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:08:37.995682 [debug] [Thread-1  ]: SQL status: OK in 0.021 seconds
[0m20:08:38.001103 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:38.001551 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:08:38.001798 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    (res2->'hourly'->'time')::date[] as time,
    (res2->'hourly'->'temperature_2m')::float[] as temperature_2m,
    (res2->'hourly'->'precipitation')::float[] as precipitation,
    (res2->'hourly'->'rain')::float[] as rain,
    (res2->'hourly'->'snowfall')::float[] as snowfall,
    (res2->'hourly'->'surface_pressure')::float[] as surface_pressure,
    (res2->'hourly'->'cloud_cover')::float[] as cloud_cover,
    (res2->'hourly'->'evapotranspiration')::float[] as evapotranspiration,
    (res2->'hourly'->'wind_speed_10m')::float[] as wind_speed_10m,
    (res2->'hourly'->'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res2->'hourly'->'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:08:38.004539 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    (res2->'hourly'->'time')::date[] as time,
    (res2->'hourly'->'temperature_2m')::float[] as temperature_2m,
    (res2->'hourly'->'precipitation')::float[] as precipitation,
    (res2->'hourly'->'rain')::float[] as rain,
    (res2->'hourly'->'snowfall')::float[] as snowfall,
    (res2->'hourly'->'surface_pressure')::float[] as surface_pressure,
    (res2->'hourly'->'cloud_cover')::float[] as cloud_cover,
    (res2->'hourly'->'evapotranspiration')::float[] as evapotranspiration,
    (res2->'hourly'->'wind_speed_10m')::float[] as wind_speed_10m,
    (res2->'hourly'->'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res2->'hourly'->'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:08:38.004819 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m20:08:38.005071 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m20:08:38.019375 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m20:08:38.019568 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:08:38.022976 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "("
[0m20:08:38.024224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213ca745-7c59-48b6-b7c6-62933c74f170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d880>]}
[0m20:08:38.024596 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.10s]
[0m20:08:38.024906 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:08:38.025195 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "(".
[0m20:08:38.025806 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:38.025994 [debug] [MainThread]: On master: BEGIN
[0m20:08:38.026139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:08:38.049345 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:08:38.049601 [debug] [MainThread]: On master: COMMIT
[0m20:08:38.049765 [debug] [MainThread]: Using duckdb connection "master"
[0m20:08:38.049905 [debug] [MainThread]: On master: COMMIT
[0m20:08:38.050092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:08:38.050243 [debug] [MainThread]: On master: Close
[0m20:08:38.051063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:38.051286 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:08:38.051452 [info ] [MainThread]: 
[0m20:08:38.051621 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m20:08:38.051998 [debug] [MainThread]: Command end result
[0m20:08:38.067696 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:08:38.068637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:08:38.072367 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:08:38.072537 [info ] [MainThread]: 
[0m20:08:38.072747 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:08:38.072919 [info ] [MainThread]: 
[0m20:08:38.073116 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "("
[0m20:08:38.073271 [info ] [MainThread]: 
[0m20:08:38.073437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:08:38.074796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1030113, "process_in_blocks": "0", "process_kernel_time": 0.30139, "process_mem_max_rss": "142901248", "process_out_blocks": "0", "process_user_time": 2.119356}
[0m20:08:38.075005 [debug] [MainThread]: Command `dbt run` failed at 20:08:38.074961 after 1.10 seconds
[0m20:08:38.075211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035f81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026b5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10374ec70>]}
[0m20:08:38.075413 [debug] [MainThread]: Flushing usage events
[0m20:08:38.358894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:49.373182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103404310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a7430>]}


============================== 20:09:49.375421 | 7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac ==============================
[0m20:09:49.375421 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:09:49.375832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:09:49.492882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c11f0>]}
[0m20:09:49.523745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10410d070>]}
[0m20:09:49.525413 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:09:49.590774 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:09:49.666082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:49.666529 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:09:49.907214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b36130>]}
[0m20:09:49.956752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:09:49.957735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:09:49.965619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b19c10>]}
[0m20:09:49.965902 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:09:49.966092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8cc70>]}
[0m20:09:49.967042 [info ] [MainThread]: 
[0m20:09:49.967234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:49.967378 [info ] [MainThread]: 
[0m20:09:49.967631 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:09:49.968063 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:09:50.026052 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:09:50.026301 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:09:50.026458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:50.058904 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:09:50.059750 [debug] [ThreadPool]: On list_database_name: Close
[0m20:09:50.060830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:09:50.061109 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:09:50.065515 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:09:50.065703 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:09:50.065855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:50.088425 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:09:50.089285 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:09:50.089477 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:09:50.089674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:09:50.089823 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:09:50.089967 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:09:50.090185 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:09:50.090609 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:09:50.090760 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:09:50.090895 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:09:50.091072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:09:50.091223 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:09:50.095162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:09:50.098705 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:09:50.098897 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:09:50.099045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:50.122096 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:09:50.122388 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:09:50.122564 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:09:50.128779 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:09:50.129573 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:09:50.130616 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:09:50.130773 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:09:50.132071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cfd60>]}
[0m20:09:50.132424 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:50.132591 [debug] [MainThread]: On master: BEGIN
[0m20:09:50.132733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:50.155055 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m20:09:50.155298 [debug] [MainThread]: On master: COMMIT
[0m20:09:50.155456 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:50.155600 [debug] [MainThread]: On master: COMMIT
[0m20:09:50.155787 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:09:50.155939 [debug] [MainThread]: On master: Close
[0m20:09:50.157161 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:09:50.157450 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:09:50.157694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:09:50.157878 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:09:50.162931 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.163356 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:09:50.178609 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.178822 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:09:50.178995 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:09:50.202090 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:09:50.202395 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.202578 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:09:50.202872 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:09:50.203486 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.203672 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:09:50.215454 [debug] [Thread-1  ]: SQL status: OK in 0.012 seconds
[0m20:09:50.221013 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.221524 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:50.221790 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    (res2->'hourly'->'time')::date[] as time,
    (res2->'hourly'->'temperature_2m')::float[] as temperature_2m,
    (res2->'hourly'->'precipitation')::float[] as precipitation,
    (res2->'hourly'->'rain')::float[] as rain,
    (res2->'hourly'->'snowfall')::float[] as snowfall,
    (res2->'hourly'->'surface_pressure')::float[] as surface_pressure,
    (res2->'hourly'->'cloud_cover')::float[] as cloud_cover,
    (res2->'hourly'->'evapotranspiration')::float[] as evapotranspiration,
    (res2->'hourly'->'wind_speed_10m')::float[] as wind_speed_10m,
    (res2->'hourly'->'soil_temperature_0cm')::float[] as soil_temperature_0cm,
    (res2->'hourly'->'soil_moisture_0_to_1cm')::float[] as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:09:51.898839 [debug] [Thread-1  ]: SQL status: OK in 1.677 seconds
[0m20:09:51.907445 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:51.907920 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:09:51.909029 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:09:51.912411 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:51.912777 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:09:51.913274 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:09:51.927301 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:09:51.927593 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:51.927856 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:09:51.929278 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:09:51.933648 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:09:51.933910 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:09:51.934429 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:09:51.936289 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:09:51.943437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a0001f0-ef0b-4d88-890c-0d8a8b7b76ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462d160>]}
[0m20:09:51.943911 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 1.78s]
[0m20:09:51.944277 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:09:51.944957 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:51.945143 [debug] [MainThread]: On master: BEGIN
[0m20:09:51.945307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:51.968327 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:09:51.968594 [debug] [MainThread]: On master: COMMIT
[0m20:09:51.968760 [debug] [MainThread]: Using duckdb connection "master"
[0m20:09:51.968912 [debug] [MainThread]: On master: COMMIT
[0m20:09:51.969115 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:09:51.969276 [debug] [MainThread]: On master: Close
[0m20:09:51.970036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:51.970185 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:09:51.970353 [info ] [MainThread]: 
[0m20:09:51.970522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:09:51.970877 [debug] [MainThread]: Command end result
[0m20:09:51.988031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:09:51.989085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:09:51.992778 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:09:51.992955 [info ] [MainThread]: 
[0m20:09:51.993173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:09:51.993333 [info ] [MainThread]: 
[0m20:09:51.993505 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:09:51.994451 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6633475, "process_in_blocks": "0", "process_kernel_time": 0.244584, "process_mem_max_rss": "159350784", "process_out_blocks": "0", "process_user_time": 2.166714}
[0m20:09:51.994660 [debug] [MainThread]: Command `dbt run` succeeded at 20:09:51.994615 after 2.66 seconds
[0m20:09:51.994874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103404310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10358a850>]}
[0m20:09:51.995081 [debug] [MainThread]: Flushing usage events
[0m20:09:52.083991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:25.638212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103868250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046faf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fabb0>]}


============================== 20:12:25.640812 | 57893d5b-0dd9-43bc-963a-850f9a3c3996 ==============================
[0m20:12:25.640812 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:12:25.641248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:25.777146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57893d5b-0dd9-43bc-963a-850f9a3c3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be48e0>]}
[0m20:12:25.807913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57893d5b-0dd9-43bc-963a-850f9a3c3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cfbe0>]}
[0m20:12:25.810473 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:12:25.880275 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:12:25.963978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:25.964387 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:12:26.221058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57893d5b-0dd9-43bc-963a-850f9a3c3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9a130>]}
[0m20:12:26.270478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:12:26.271726 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:12:26.282825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57893d5b-0dd9-43bc-963a-850f9a3c3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a960d0>]}
[0m20:12:26.283126 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:12:26.283324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57893d5b-0dd9-43bc-963a-850f9a3c3996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa9f70>]}
[0m20:12:26.284313 [info ] [MainThread]: 
[0m20:12:26.284506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:26.284661 [info ] [MainThread]: 
[0m20:12:26.284929 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:26.285404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:12:26.349372 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:12:26.349654 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:12:26.349810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:26.375782 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:12:26.376023 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m20:12:26.376476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:26.376636 [debug] [MainThread]: Connection 'list_database_name' was properly closed.
[0m20:12:26.376803 [info ] [MainThread]: 
[0m20:12:26.376981 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m20:12:26.377262 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/ericliao/climate_elt/dbt/duck_db_files/database_name.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 63643) by user ericliao. See also https://duckdb.org/docs/connect/concurrency
[0m20:12:26.378174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.784173, "process_in_blocks": "0", "process_kernel_time": 0.168948, "process_mem_max_rss": "121634816", "process_out_blocks": "0", "process_user_time": 1.261144}
[0m20:12:26.378388 [debug] [MainThread]: Command `dbt run` failed at 20:12:26.378342 after 0.78 seconds
[0m20:12:26.378580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103868250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cae0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f14520>]}
[0m20:12:26.378784 [debug] [MainThread]: Flushing usage events
[0m20:12:26.572831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:39.622683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a24bb0>]}


============================== 20:12:39.624981 | f2bda708-ef85-4cd3-8483-dd129cdf60cd ==============================
[0m20:12:39.624981 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:12:39.625386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m20:12:39.743506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106306be0>]}
[0m20:12:39.774549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3bb20>]}
[0m20:12:39.776260 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:12:39.844337 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:12:39.916472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:39.916691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:39.943128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b8130>]}
[0m20:12:39.993538 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:12:39.994455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:12:40.001651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f75e0>]}
[0m20:12:40.001930 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:12:40.002126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112dfe50>]}
[0m20:12:40.003058 [info ] [MainThread]: 
[0m20:12:40.003252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:40.003406 [info ] [MainThread]: 
[0m20:12:40.003680 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:12:40.004120 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:12:40.030891 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:12:40.031111 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:12:40.031268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:40.091386 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m20:12:40.092473 [debug] [ThreadPool]: On list_database_name: Close
[0m20:12:40.094263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:12:40.094562 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:12:40.098710 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:12:40.098899 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:12:40.099054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:40.120936 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:12:40.121804 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:12:40.121976 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:12:40.122186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:40.122329 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:12:40.122468 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:12:40.123078 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:40.123716 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:12:40.123890 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:12:40.124038 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:12:40.124268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:40.124421 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:12:40.128198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:12:40.131726 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:12:40.131902 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:12:40.132049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:40.154820 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:12:40.155063 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:12:40.155223 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:12:40.162397 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:12:40.163201 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:12:40.164494 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:12:40.164671 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:12:40.165820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111301400>]}
[0m20:12:40.166084 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:40.166230 [debug] [MainThread]: On master: BEGIN
[0m20:12:40.166362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:40.188370 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m20:12:40.188604 [debug] [MainThread]: On master: COMMIT
[0m20:12:40.188758 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:40.188898 [debug] [MainThread]: On master: COMMIT
[0m20:12:40.189078 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:40.189228 [debug] [MainThread]: On master: Close
[0m20:12:40.190549 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:12:40.190848 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:12:40.191125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:12:40.191314 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:12:40.196990 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.197410 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:12:40.212287 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.212517 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:12:40.212695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:12:40.236984 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m20:12:40.237268 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.237452 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:12:40.238091 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:12:40.238906 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.239119 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:12:40.257149 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m20:12:40.263056 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.263498 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:40.263751 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    (res2->'hourly'->'time')::date[] as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:12:41.893957 [debug] [Thread-1  ]: SQL status: OK in 1.630 seconds
[0m20:12:41.901619 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:41.901982 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:12:41.903178 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:12:41.905931 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:41.906216 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:12:41.906613 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:12:41.918593 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:12:41.918861 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:41.919089 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:12:41.921034 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m20:12:41.924683 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:12:41.924980 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:12:41.925694 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:12:41.927294 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:12:41.935829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2bda708-ef85-4cd3-8483-dd129cdf60cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111730220>]}
[0m20:12:41.936251 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 1.74s]
[0m20:12:41.936578 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:12:41.937182 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:41.937350 [debug] [MainThread]: On master: BEGIN
[0m20:12:41.937498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:41.961967 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:12:41.962223 [debug] [MainThread]: On master: COMMIT
[0m20:12:41.962376 [debug] [MainThread]: Using duckdb connection "master"
[0m20:12:41.962516 [debug] [MainThread]: On master: COMMIT
[0m20:12:41.962698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:12:41.962845 [debug] [MainThread]: On master: Close
[0m20:12:41.963667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:41.963932 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:12:41.964106 [info ] [MainThread]: 
[0m20:12:41.964283 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m20:12:41.964649 [debug] [MainThread]: Command end result
[0m20:12:41.981365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:12:41.982387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:12:41.986179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:12:41.986355 [info ] [MainThread]: 
[0m20:12:41.986591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:41.986750 [info ] [MainThread]: 
[0m20:12:41.986929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:12:41.987834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.407397, "process_in_blocks": "0", "process_kernel_time": 0.295462, "process_mem_max_rss": "167346176", "process_out_blocks": "0", "process_user_time": 1.917241}
[0m20:12:41.988056 [debug] [MainThread]: Command `dbt run` succeeded at 20:12:41.988007 after 2.41 seconds
[0m20:12:41.988263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063359d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105489190>]}
[0m20:12:41.988453 [debug] [MainThread]: Flushing usage events
[0m20:12:42.081110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:40.362518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2f460>]}


============================== 20:21:40.365335 | 52c3db9d-8354-4a21-8a0a-2fa4eda5c280 ==============================
[0m20:21:40.365335 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:21:40.365753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:21:40.503517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103007be0>]}
[0m20:21:40.537645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e38b20>]}
[0m20:21:40.540112 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:21:40.614752 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:21:40.707417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:21:40.707945 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:21:40.957411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c3130>]}
[0m20:21:41.010409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:21:41.011880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:21:41.024187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a0250>]}
[0m20:21:41.024517 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:21:41.024722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468ca90>]}
[0m20:21:41.025751 [info ] [MainThread]: 
[0m20:21:41.025965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:41.026125 [info ] [MainThread]: 
[0m20:21:41.026421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:21:41.026897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:21:41.095292 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:21:41.095559 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:21:41.095721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:41.194112 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m20:21:41.195299 [debug] [ThreadPool]: On list_database_name: Close
[0m20:21:41.197018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:21:41.197322 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:21:41.201505 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:21:41.201688 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:21:41.201843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:41.226575 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:21:41.227753 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:21:41.227946 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:21:41.228208 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:41.228362 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:21:41.228515 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:21:41.229223 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:21:41.229708 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:21:41.229874 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:21:41.230016 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:21:41.230205 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:21:41.230359 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:21:41.234188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:21:41.237761 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:21:41.237942 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:21:41.238085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:41.261136 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:21:41.261378 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:21:41.261539 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:21:41.271602 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:21:41.272392 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:21:41.273694 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:21:41.273858 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:21:41.275086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104718490>]}
[0m20:21:41.275391 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:41.275554 [debug] [MainThread]: On master: BEGIN
[0m20:21:41.275687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:41.298861 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:21:41.299139 [debug] [MainThread]: On master: COMMIT
[0m20:21:41.299314 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:41.299457 [debug] [MainThread]: On master: COMMIT
[0m20:21:41.299640 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:41.299795 [debug] [MainThread]: On master: Close
[0m20:21:41.301162 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:21:41.301561 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:21:41.301830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:21:41.302029 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:21:41.307281 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.307712 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:21:41.323150 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.323370 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:21:41.323546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:21:41.348544 [debug] [Thread-1  ]: SQL status: OK in 0.025 seconds
[0m20:21:41.348844 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.349028 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:21:41.349606 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:21:41.350385 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.350603 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:21:41.370056 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m20:21:41.375557 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.375996 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:41.376246 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::date[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:21:42.164430 [debug] [Thread-1  ]: SQL status: OK in 0.788 seconds
[0m20:21:42.172889 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:42.173320 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:21:42.174530 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:21:42.177646 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:42.177951 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:21:42.178385 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:21:42.191485 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:21:42.191778 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:42.192030 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:21:42.193611 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:21:42.197516 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:21:42.197784 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:21:42.198665 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:21:42.200403 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:21:42.210377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52c3db9d-8354-4a21-8a0a-2fa4eda5c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408db50>]}
[0m20:21:42.210863 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 0.91s]
[0m20:21:42.211232 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:21:42.211957 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:42.212179 [debug] [MainThread]: On master: BEGIN
[0m20:21:42.212364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:42.236732 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:21:42.236982 [debug] [MainThread]: On master: COMMIT
[0m20:21:42.237145 [debug] [MainThread]: Using duckdb connection "master"
[0m20:21:42.237286 [debug] [MainThread]: On master: COMMIT
[0m20:21:42.237469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:21:42.237621 [debug] [MainThread]: On master: Close
[0m20:21:42.238437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:42.238677 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:21:42.238856 [info ] [MainThread]: 
[0m20:21:42.239041 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m20:21:42.239404 [debug] [MainThread]: Command end result
[0m20:21:42.256267 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:21:42.257327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:21:42.261178 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:21:42.261387 [info ] [MainThread]: 
[0m20:21:42.261616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:21:42.261776 [info ] [MainThread]: 
[0m20:21:42.261947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:21:42.262915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9453127, "process_in_blocks": "0", "process_kernel_time": 0.343685, "process_mem_max_rss": "159760384", "process_out_blocks": "0", "process_user_time": 2.182896}
[0m20:21:42.263129 [debug] [MainThread]: Command `dbt run` succeeded at 20:21:42.263082 after 1.95 seconds
[0m20:21:42.263338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030359d0>]}
[0m20:21:42.263535 [debug] [MainThread]: Flushing usage events
[0m20:21:42.467989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:16.478574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef23d0>]}


============================== 20:23:16.481457 | 97655cab-6d89-47f9-9ff0-30180f81fa1f ==============================
[0m20:23:16.481457 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:23:16.481876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:23:16.624356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e5ac0>]}
[0m20:23:16.657833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91fa0>]}
[0m20:23:16.660875 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:23:16.734658 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:23:16.823373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:16.823865 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:23:17.069485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a82130>]}
[0m20:23:17.118809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:23:17.120074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:23:17.131043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a65460>]}
[0m20:23:17.131337 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:23:17.131538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad8be0>]}
[0m20:23:17.132545 [info ] [MainThread]: 
[0m20:23:17.132747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:23:17.132900 [info ] [MainThread]: 
[0m20:23:17.133171 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:23:17.133628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:23:17.195560 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:23:17.195813 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:23:17.195965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:17.278822 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m20:23:17.280057 [debug] [ThreadPool]: On list_database_name: Close
[0m20:23:17.281803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:23:17.282113 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:23:17.286366 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:23:17.286554 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:23:17.286708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:17.309925 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:23:17.310821 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:23:17.311003 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:23:17.311208 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:17.311354 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:23:17.311494 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:23:17.312158 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:23:17.312644 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:23:17.312811 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:23:17.312954 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:23:17.313145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:23:17.313295 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:23:17.317008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:23:17.320442 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:23:17.320620 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:23:17.320764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:17.343855 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:23:17.344092 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:23:17.344245 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:23:17.353237 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:23:17.354024 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:23:17.355253 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:23:17.355421 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:23:17.356560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a604c0>]}
[0m20:23:17.356835 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:17.356991 [debug] [MainThread]: On master: BEGIN
[0m20:23:17.357126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:17.379225 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m20:23:17.379477 [debug] [MainThread]: On master: COMMIT
[0m20:23:17.379632 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:17.379774 [debug] [MainThread]: On master: COMMIT
[0m20:23:17.379957 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:17.380110 [debug] [MainThread]: On master: Close
[0m20:23:17.381456 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:23:17.381774 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:23:17.382046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:23:17.382229 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:23:17.387455 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.387906 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:23:17.403227 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.403466 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:23:17.403645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:23:17.427040 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:23:17.427353 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.427544 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:23:17.428115 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:23:17.428908 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.429116 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:23:17.448416 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m20:23:17.454038 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.454501 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:17.454763 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::datetime[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:23:18.204052 [debug] [Thread-1  ]: SQL status: OK in 0.749 seconds
[0m20:23:18.210569 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:18.211027 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:23:18.212148 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:23:18.215095 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:18.215446 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:23:18.215925 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:23:18.228832 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:23:18.229161 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:18.229474 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:23:18.231172 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:23:18.235409 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:23:18.235704 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:23:18.236518 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:23:18.238360 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:23:18.247159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97655cab-6d89-47f9-9ff0-30180f81fa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d57c0>]}
[0m20:23:18.247628 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 0.86s]
[0m20:23:18.247985 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:23:18.248645 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:18.248865 [debug] [MainThread]: On master: BEGIN
[0m20:23:18.249044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:23:18.273302 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:23:18.273589 [debug] [MainThread]: On master: COMMIT
[0m20:23:18.273758 [debug] [MainThread]: Using duckdb connection "master"
[0m20:23:18.273910 [debug] [MainThread]: On master: COMMIT
[0m20:23:18.274103 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:23:18.274262 [debug] [MainThread]: On master: Close
[0m20:23:18.275021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:18.275163 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:23:18.275323 [info ] [MainThread]: 
[0m20:23:18.275490 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m20:23:18.275879 [debug] [MainThread]: Command end result
[0m20:23:18.292903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:23:18.293892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:23:18.297764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:23:18.298002 [info ] [MainThread]: 
[0m20:23:18.298229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:18.298396 [info ] [MainThread]: 
[0m20:23:18.298569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:23:18.299538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8676827, "process_in_blocks": "0", "process_kernel_time": 0.341506, "process_mem_max_rss": "156778496", "process_out_blocks": "0", "process_user_time": 2.186221}
[0m20:23:18.299758 [debug] [MainThread]: Command `dbt run` succeeded at 20:23:18.299709 after 1.87 seconds
[0m20:23:18.299968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f91fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105821fd0>]}
[0m20:23:18.300173 [debug] [MainThread]: Flushing usage events
[0m20:23:18.513965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:57.309350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2c40>]}


============================== 20:39:57.312232 | 8e210fb2-aa6f-42d6-85e6-c0e874f7b32b ==============================
[0m20:39:57.312232 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:39:57.312646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:57.450264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104415ac0>]}
[0m20:39:57.481242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107793fa0>]}
[0m20:39:57.483219 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:39:57.551481 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:39:57.637945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:57.638378 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m20:39:57.880705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108287130>]}
[0m20:39:57.929276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:39:57.932511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:39:57.944180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108267700>]}
[0m20:39:57.944473 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:39:57.944670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d6a90>]}
[0m20:39:57.945647 [info ] [MainThread]: 
[0m20:39:57.945844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:57.945993 [info ] [MainThread]: 
[0m20:39:57.946255 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:39:57.946715 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:39:58.012211 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:39:58.012460 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:39:58.012614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:58.093094 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m20:39:58.094173 [debug] [ThreadPool]: On list_database_name: Close
[0m20:39:58.095793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:39:58.096093 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:39:58.100244 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:39:58.100426 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:39:58.100582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:58.124549 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m20:39:58.125597 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:39:58.125850 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:39:58.126189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:58.126382 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:39:58.126548 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:39:58.127061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:58.127691 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:39:58.127889 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:39:58.128052 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:39:58.128279 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:58.128438 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:39:58.132295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:39:58.136157 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:39:58.136420 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:39:58.136579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:58.161645 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m20:39:58.161920 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:39:58.162085 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:39:58.169546 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:39:58.170364 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:39:58.171606 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:39:58.171783 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:39:58.173051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d9cd0>]}
[0m20:39:58.173310 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:58.173457 [debug] [MainThread]: On master: BEGIN
[0m20:39:58.173591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:58.196207 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:39:58.196461 [debug] [MainThread]: On master: COMMIT
[0m20:39:58.196618 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:58.196760 [debug] [MainThread]: On master: COMMIT
[0m20:39:58.196947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:39:58.197110 [debug] [MainThread]: On master: Close
[0m20:39:58.198466 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:39:58.198774 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:39:58.199054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:39:58.199235 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:39:58.204438 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.205004 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:39:58.220500 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.220721 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:39:58.220895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:39:58.244094 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m20:39:58.244384 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.244570 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:39:58.245069 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:39:58.245727 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.245923 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:39:58.263533 [debug] [Thread-1  ]: SQL status: OK in 0.017 seconds
[0m20:39:58.268921 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.269324 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:58.269580 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:39:59.070717 [debug] [Thread-1  ]: SQL status: OK in 0.801 seconds
[0m20:39:59.079702 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:59.080156 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:39:59.081606 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:39:59.084932 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:59.085255 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:39:59.085728 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:39:59.090327 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:59.090654 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * from "database_name"."main"."open_meteo_raw_data")
      
[0m20:39:59.093465 [debug] [Thread-1  ]: SQL status: OK in 0.002 seconds
[0m20:39:59.102998 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:39:59.103278 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:59.103520 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:39:59.105133 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:39:59.108874 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:39:59.109139 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:39:59.109862 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:39:59.111505 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:39:59.123170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e210fb2-aa6f-42d6-85e6-c0e874f7b32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb5b50>]}
[0m20:39:59.123611 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 0.92s]
[0m20:39:59.123944 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:39:59.124623 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:59.124830 [debug] [MainThread]: On master: BEGIN
[0m20:39:59.124994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:59.148731 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m20:39:59.149013 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.149174 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:59.149315 [debug] [MainThread]: On master: COMMIT
[0m20:39:59.149504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:39:59.149651 [debug] [MainThread]: On master: Close
[0m20:39:59.150494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:59.150734 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:39:59.150907 [info ] [MainThread]: 
[0m20:39:59.151084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m20:39:59.151458 [debug] [MainThread]: Command end result
[0m20:39:59.167651 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:39:59.168554 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:39:59.172097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:39:59.172267 [info ] [MainThread]: 
[0m20:39:59.172492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:59.172651 [info ] [MainThread]: 
[0m20:39:59.172825 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:39:59.173785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9111668, "process_in_blocks": "0", "process_kernel_time": 0.335158, "process_mem_max_rss": "158171136", "process_out_blocks": "0", "process_user_time": 2.163957}
[0m20:39:59.173997 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:59.173951 after 1.91 seconds
[0m20:39:59.174190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104415ac0>]}
[0m20:39:59.174383 [debug] [MainThread]: Flushing usage events
[0m20:39:59.346500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:40:33.577198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7ebe0>]}


============================== 20:40:33.580440 | dad8a99a-1f23-4d99-a08e-bed8ddd31ee9 ==============================
[0m20:40:33.580440 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:40:33.580946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:33.720091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5e4f0>]}
[0m20:40:33.751229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079569d0>]}
[0m20:40:33.753771 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m20:40:33.828209 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:40:33.914315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:33.914543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:33.941422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11053a130>]}
[0m20:40:34.030523 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:40:34.032076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:40:34.045726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055d6a0>]}
[0m20:40:34.046134 [info ] [MainThread]: Found 2 models, 28 data tests, 424 macros
[0m20:40:34.046356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055e6a0>]}
[0m20:40:34.047501 [info ] [MainThread]: 
[0m20:40:34.047748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:34.047906 [info ] [MainThread]: 
[0m20:40:34.048205 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:40:34.048795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m20:40:34.087879 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m20:40:34.088184 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m20:40:34.088358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:34.201281 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m20:40:34.202666 [debug] [ThreadPool]: On list_database_name: Close
[0m20:40:34.204412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m20:40:34.204713 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m20:40:34.209284 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:40:34.209518 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m20:40:34.209672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.237839 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m20:40:34.239122 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:40:34.239428 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m20:40:34.239802 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:40:34.240009 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:40:34.240172 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m20:40:34.240990 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:40:34.241569 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:40:34.241766 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m20:40:34.241921 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m20:40:34.242200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:40:34.242397 [debug] [ThreadPool]: On create_database_name_main: Close
[0m20:40:34.246466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m20:40:34.250377 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:40:34.250559 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m20:40:34.250702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:34.273828 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:40:34.274134 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m20:40:34.274303 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m20:40:34.285378 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:40:34.286227 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m20:40:34.287500 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m20:40:34.287661 [debug] [ThreadPool]: On list_database_name_main: Close
[0m20:40:34.289066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11214b970>]}
[0m20:40:34.289377 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:34.289540 [debug] [MainThread]: On master: BEGIN
[0m20:40:34.289679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:34.312792 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:40:34.313063 [debug] [MainThread]: On master: COMMIT
[0m20:40:34.313231 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:34.313378 [debug] [MainThread]: On master: COMMIT
[0m20:40:34.313568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:40:34.313731 [debug] [MainThread]: On master: Close
[0m20:40:34.315173 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m20:40:34.315499 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m20:40:34.315784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m20:40:34.315970 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m20:40:34.321808 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.322292 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m20:40:34.337369 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.337602 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m20:40:34.337779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:34.361704 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m20:40:34.362008 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.362198 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m20:40:34.362841 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:40:34.363651 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.363866 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m20:40:34.382618 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m20:40:34.388137 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.388596 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:34.388860 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':'35.23',
          'longitude':'-80.84',
          'start_date':'2025-01-22',
          'end_date':'2025-02-05',
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m20:40:35.085550 [debug] [Thread-1  ]: SQL status: OK in 0.696 seconds
[0m20:40:35.093200 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:35.093595 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m20:40:35.094688 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:40:35.097941 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:35.098297 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m20:40:35.098789 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m20:40:35.103277 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:35.103601 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * from "database_name"."main"."open_meteo_raw_data")
      
[0m20:40:35.106593 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m20:40:35.116236 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:40:35.116512 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:35.116734 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m20:40:35.118390 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:40:35.122150 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m20:40:35.122410 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m20:40:35.123161 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m20:40:35.124937 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m20:40:35.135841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dad8a99a-1f23-4d99-a08e-bed8ddd31ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608c910>]}
[0m20:40:35.136290 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 0.82s]
[0m20:40:35.136640 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m20:40:35.137262 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:35.137448 [debug] [MainThread]: On master: BEGIN
[0m20:40:35.137604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:35.161138 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:40:35.161384 [debug] [MainThread]: On master: COMMIT
[0m20:40:35.161539 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:35.161677 [debug] [MainThread]: On master: COMMIT
[0m20:40:35.161856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:40:35.162005 [debug] [MainThread]: On master: Close
[0m20:40:35.162811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:35.162977 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m20:40:35.163143 [info ] [MainThread]: 
[0m20:40:35.163316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m20:40:35.163670 [debug] [MainThread]: Command end result
[0m20:40:35.180316 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m20:40:35.181216 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m20:40:35.185372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m20:40:35.185606 [info ] [MainThread]: 
[0m20:40:35.185845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:35.186013 [info ] [MainThread]: 
[0m20:40:35.186186 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:40:35.187213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6609644, "process_in_blocks": "0", "process_kernel_time": 0.361471, "process_mem_max_rss": "156057600", "process_out_blocks": "0", "process_user_time": 1.973034}
[0m20:40:35.187438 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:35.187388 after 1.66 seconds
[0m20:40:35.187646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fec280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5e4f0>]}
[0m20:40:35.187852 [debug] [MainThread]: Flushing usage events
[0m20:40:35.279863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:04:34.972277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107776f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107776c40>]}


============================== 21:04:34.975300 | 537d3f54-c920-4c4b-b29c-f40a7ad4eefa ==============================
[0m21:04:34.975300 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:04:34.975739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:35.112338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784fc10>]}
[0m21:04:35.144009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072196a0>]}
[0m21:04:35.146156 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:04:35.215339 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:04:35.303547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:04:35.303947 [debug] [MainThread]: Partial parsing: added file: weather_dbt_project://seeds/cities_info.csv
[0m21:04:35.304254 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:04:35.629602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108182640>]}
[0m21:04:35.716281 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:04:35.717427 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:04:35.729042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e760>]}
[0m21:04:35.729345 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:04:35.729541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c3c70>]}
[0m21:04:35.730535 [info ] [MainThread]: 
[0m21:04:35.730717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:35.730872 [info ] [MainThread]: 
[0m21:04:35.731145 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:04:35.731621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:04:35.770237 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:04:35.770497 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:04:35.770655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:35.869387 [debug] [ThreadPool]: SQL status: OK in 0.099 seconds
[0m21:04:35.870368 [debug] [ThreadPool]: On list_database_name: Close
[0m21:04:35.872095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:04:35.872417 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:04:35.876853 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:04:35.877041 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:04:35.877195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:35.900521 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:04:35.901577 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:04:35.901747 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:04:35.901942 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:04:35.902094 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:04:35.902243 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:04:35.902894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:04:35.903372 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:04:35.903531 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:04:35.903674 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:04:35.903857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:04:35.904010 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:04:35.907791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:04:35.911213 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:04:35.911392 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:04:35.911535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:35.935180 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:04:35.935413 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:04:35.935569 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:04:35.945803 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:04:35.946574 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:04:35.947819 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:04:35.947985 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:04:35.949425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d86af0>]}
[0m21:04:35.949711 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:35.949864 [debug] [MainThread]: On master: BEGIN
[0m21:04:35.949996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:35.974636 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m21:04:35.974932 [debug] [MainThread]: On master: COMMIT
[0m21:04:35.975101 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:35.975250 [debug] [MainThread]: On master: COMMIT
[0m21:04:35.975453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:04:35.975610 [debug] [MainThread]: On master: Close
[0m21:04:35.977147 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:04:35.977536 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:04:35.977843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:04:35.978029 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:04:35.983505 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:35.983947 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:04:35.998812 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:35.999031 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:04:35.999205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:36.022814 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:04:36.023123 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:36.023313 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:04:36.023896 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:04:36.024615 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:36.024818 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:04:36.042499 [debug] [Thread-1  ]: SQL status: OK in 0.017 seconds
[0m21:04:36.047718 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:36.048159 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:04:36.048417 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval -2 day)::string,
          'end_date':current_date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:04:36.051644 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval -2 day)::string,
          'end_date':current_date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:04:36.051926 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m21:04:36.052170 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m21:04:36.066408 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m21:04:36.066617 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:04:36.070235 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "day"
[0m21:04:36.071494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537d3f54-c920-4c4b-b29c-f40a7ad4eefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bd220>]}
[0m21:04:36.071880 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.09s]
[0m21:04:36.072198 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:04:36.072490 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "day".
[0m21:04:36.073103 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:36.073272 [debug] [MainThread]: On master: BEGIN
[0m21:04:36.073415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:36.095905 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m21:04:36.096140 [debug] [MainThread]: On master: COMMIT
[0m21:04:36.096289 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:36.096423 [debug] [MainThread]: On master: COMMIT
[0m21:04:36.096605 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:04:36.096754 [debug] [MainThread]: On master: Close
[0m21:04:36.097595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:36.097827 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:04:36.097994 [info ] [MainThread]: 
[0m21:04:36.098164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:04:36.098511 [debug] [MainThread]: Command end result
[0m21:04:36.115800 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:04:36.116829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:04:36.120511 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:04:36.120694 [info ] [MainThread]: 
[0m21:04:36.120924 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:04:36.121099 [info ] [MainThread]: 
[0m21:04:36.121293 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Parser Error: syntax error at or near "day"
[0m21:04:36.121447 [info ] [MainThread]: 
[0m21:04:36.121619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:04:36.122611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1980681, "process_in_blocks": "0", "process_kernel_time": 0.333553, "process_mem_max_rss": "143343616", "process_out_blocks": "0", "process_user_time": 2.212219}
[0m21:04:36.122832 [debug] [MainThread]: Command `dbt run` failed at 21:04:36.122785 after 1.20 seconds
[0m21:04:36.123032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f0670>]}
[0m21:04:36.123225 [debug] [MainThread]: Flushing usage events
[0m21:04:36.417950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:02.838191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107562c40>]}


============================== 21:07:02.841002 | 604c018d-7625-4a41-bb8c-03cdefe624e1 ==============================
[0m21:07:02.841002 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:07:02.841430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:07:02.975512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107741c10>]}
[0m21:07:03.010054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070056a0>]}
[0m21:07:03.012985 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:07:03.087206 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:07:03.182723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:07:03.183163 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:07:03.435747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111326fd0>]}
[0m21:07:03.492846 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:07:03.494284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:07:03.533312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111144700>]}
[0m21:07:03.533666 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:07:03.533855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111449d0>]}
[0m21:07:03.534857 [info ] [MainThread]: 
[0m21:07:03.535047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:07:03.535196 [info ] [MainThread]: 
[0m21:07:03.535449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:07:03.535893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:07:03.570642 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:07:03.570917 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:07:03.571081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:03.672252 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m21:07:03.673518 [debug] [ThreadPool]: On list_database_name: Close
[0m21:07:03.675056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:07:03.675519 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:07:03.679674 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:07:03.679862 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:07:03.680015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:03.703229 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:07:03.704337 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:07:03.704513 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:07:03.704713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:07:03.704857 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:07:03.704999 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:07:03.705259 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:07:03.705707 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:07:03.705856 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:07:03.705990 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:07:03.706166 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:07:03.706320 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:07:03.710302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:07:03.714250 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:07:03.714441 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:07:03.714590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:03.738234 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:07:03.738508 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:07:03.738681 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:07:03.747493 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:07:03.748314 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:07:03.749598 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:07:03.749766 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:07:03.751182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104089af0>]}
[0m21:07:03.751497 [debug] [MainThread]: Using duckdb connection "master"
[0m21:07:03.751653 [debug] [MainThread]: On master: BEGIN
[0m21:07:03.751789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:03.775601 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:07:03.775881 [debug] [MainThread]: On master: COMMIT
[0m21:07:03.776042 [debug] [MainThread]: Using duckdb connection "master"
[0m21:07:03.776186 [debug] [MainThread]: On master: COMMIT
[0m21:07:03.776388 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:07:03.776540 [debug] [MainThread]: On master: Close
[0m21:07:03.777931 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:07:03.778323 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:07:03.778623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:07:03.778826 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:07:03.784276 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.784737 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:07:03.799505 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.799720 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:07:03.799903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:07:03.823281 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m21:07:03.823554 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.823735 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:07:03.824366 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:07:03.825154 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.825374 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:07:03.843997 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:07:03.849435 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.849861 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:07:03.850123 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-2) day)::string,
          'end_date':current_date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:07:03.858992 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-2) day)::string,
          'end_date':current_date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:07:03.859286 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m21:07:03.859546 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m21:07:03.875189 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m21:07:03.875396 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:07:03.879417 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Catalog Error: Table with name cities_info does not exist!
  Did you mean "weather_accumulation_data"?
  
  LINE 38:     "database_name"."main"."cities_info"
               ^
[0m21:07:03.880715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604c018d-7625-4a41-bb8c-03cdefe624e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa5640>]}
[0m21:07:03.881106 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 0.10s]
[0m21:07:03.881431 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:07:03.881728 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Catalog Error: Table with name cities_info does not exist!
  Did you mean "weather_accumulation_data"?
  
  LINE 38:     "database_name"."main"."cities_info"
               ^.
[0m21:07:03.882413 [debug] [MainThread]: Using duckdb connection "master"
[0m21:07:03.882576 [debug] [MainThread]: On master: BEGIN
[0m21:07:03.882720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:07:03.906787 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:07:03.907102 [debug] [MainThread]: On master: COMMIT
[0m21:07:03.907267 [debug] [MainThread]: Using duckdb connection "master"
[0m21:07:03.907412 [debug] [MainThread]: On master: COMMIT
[0m21:07:03.907603 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:07:03.907754 [debug] [MainThread]: On master: Close
[0m21:07:03.908654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:03.908894 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:07:03.909070 [info ] [MainThread]: 
[0m21:07:03.909249 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:07:03.909630 [debug] [MainThread]: Command end result
[0m21:07:03.926989 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:07:03.927976 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:07:03.931584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:07:03.931756 [info ] [MainThread]: 
[0m21:07:03.931967 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:07:03.932136 [info ] [MainThread]: 
[0m21:07:03.932334 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Catalog Error: Table with name cities_info does not exist!
  Did you mean "weather_accumulation_data"?
  
  LINE 38:     "database_name"."main"."cities_info"
               ^
[0m21:07:03.932494 [info ] [MainThread]: 
[0m21:07:03.932659 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:07:03.933629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1433854, "process_in_blocks": "0", "process_kernel_time": 0.338405, "process_mem_max_rss": "143360000", "process_out_blocks": "0", "process_user_time": 2.165131}
[0m21:07:03.933832 [debug] [MainThread]: Command `dbt run` failed at 21:07:03.933789 after 1.14 seconds
[0m21:07:03.934045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ffd00>]}
[0m21:07:03.934242 [debug] [MainThread]: Flushing usage events
[0m21:07:04.145128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:01.715548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112062f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112062040>]}


============================== 21:08:01.718668 | c28e520a-3394-4d91-b089-322ac782c0fa ==============================
[0m21:08:01.718668 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:08:01.719013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:01.852799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bd7c0>]}
[0m21:08:01.883370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c9e50>]}
[0m21:08:01.885757 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:08:01.960656 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:08:02.055704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:02.055942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:02.089300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112723130>]}
[0m21:08:02.146031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:08:02.147296 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:08:02.158742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112723eb0>]}
[0m21:08:02.159032 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:08:02.159230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276be50>]}
[0m21:08:02.160198 [info ] [MainThread]: 
[0m21:08:02.160390 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:02.160543 [info ] [MainThread]: 
[0m21:08:02.160814 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:02.161260 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:08:02.196649 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:08:02.196918 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:08:02.197076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:02.282419 [debug] [ThreadPool]: SQL status: OK in 0.085 seconds
[0m21:08:02.283402 [debug] [ThreadPool]: On list_database_name: Close
[0m21:08:02.285281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:08:02.285572 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:08:02.290279 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:02.290521 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:08:02.290691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:02.317287 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m21:08:02.318445 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:02.318625 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:08:02.318833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:02.318979 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:02.319122 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:08:02.319595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:02.320024 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:08:02.320175 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:02.320310 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:08:02.320493 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:02.320645 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:08:02.325710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:08:02.329620 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:08:02.329799 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:08:02.329944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:02.353187 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:08:02.353468 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:08:02.353636 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:08:02.362331 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:08:02.363242 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:08:02.364604 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:08:02.364780 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:08:02.366137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070153d0>]}
[0m21:08:02.366421 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:02.366580 [debug] [MainThread]: On master: BEGIN
[0m21:08:02.366721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:02.390780 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:08:02.391073 [debug] [MainThread]: On master: COMMIT
[0m21:08:02.391239 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:02.391385 [debug] [MainThread]: On master: COMMIT
[0m21:08:02.391576 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:02.391731 [debug] [MainThread]: On master: Close
[0m21:08:02.393057 [debug] [Thread-1  ]: Began running node seed.weather_dbt_project.cities_info
[0m21:08:02.393417 [info ] [Thread-1  ]: 1 of 1 START seed file main.cities_info ........................................ [RUN]
[0m21:08:02.393689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now seed.weather_dbt_project.cities_info)
[0m21:08:02.393882 [debug] [Thread-1  ]: Began compiling node seed.weather_dbt_project.cities_info
[0m21:08:02.394065 [debug] [Thread-1  ]: Began executing node seed.weather_dbt_project.cities_info
[0m21:08:02.410748 [debug] [Thread-1  ]: Using duckdb connection "seed.weather_dbt_project.cities_info"
[0m21:08:02.410968 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: BEGIN
[0m21:08:02.411146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:02.435814 [debug] [Thread-1  ]: SQL status: OK in 0.025 seconds
[0m21:08:02.436116 [debug] [Thread-1  ]: Using duckdb connection "seed.weather_dbt_project.cities_info"
[0m21:08:02.436303 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "seed.weather_dbt_project.cities_info"} */

    create table "database_name"."main"."cities_info" ("city" text,"latitude" float8,"longitude" float8)
  
[0m21:08:02.436643 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:02.443638 [debug] [Thread-1  ]: Using duckdb connection "seed.weather_dbt_project.cities_info"
[0m21:08:02.443865 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: 
          COPY "database_name"."main"."cities_info" FROM '/Users/ericliao/climate_elt/dbt/seeds/cities_info.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:08:02.447580 [debug] [Thread-1  ]: SQL status: OK in 0.004 seconds
[0m21:08:02.450714 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.weather_dbt_project.cities_info"
[0m21:08:02.458438 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: COMMIT
[0m21:08:02.458644 [debug] [Thread-1  ]: Using duckdb connection "seed.weather_dbt_project.cities_info"
[0m21:08:02.458819 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: COMMIT
[0m21:08:02.459474 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:02.460550 [debug] [Thread-1  ]: On seed.weather_dbt_project.cities_info: Close
[0m21:08:02.467244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c28e520a-3394-4d91-b089-322ac782c0fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d104c0>]}
[0m21:08:02.467624 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file main.cities_info .................................... [[32mINSERT 50[0m in 0.07s]
[0m21:08:02.467956 [debug] [Thread-1  ]: Finished running node seed.weather_dbt_project.cities_info
[0m21:08:02.468598 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:02.468780 [debug] [MainThread]: On master: BEGIN
[0m21:08:02.468932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:02.493366 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:08:02.493626 [debug] [MainThread]: On master: COMMIT
[0m21:08:02.493779 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:02.493920 [debug] [MainThread]: On master: COMMIT
[0m21:08:02.494100 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:02.494248 [debug] [MainThread]: On master: Close
[0m21:08:02.495042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:02.495188 [debug] [MainThread]: Connection 'seed.weather_dbt_project.cities_info' was properly closed.
[0m21:08:02.495341 [info ] [MainThread]: 
[0m21:08:02.495517 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m21:08:02.495896 [debug] [MainThread]: Command end result
[0m21:08:02.511802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:08:02.512697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:08:02.516550 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:08:02.516734 [info ] [MainThread]: 
[0m21:08:02.516961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:02.517122 [info ] [MainThread]: 
[0m21:08:02.517299 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:08:02.518257 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.84958035, "process_in_blocks": "0", "process_kernel_time": 0.302433, "process_mem_max_rss": "140820480", "process_out_blocks": "0", "process_user_time": 1.8588}
[0m21:08:02.518469 [debug] [MainThread]: Command `dbt seed` succeeded at 21:08:02.518426 after 0.85 seconds
[0m21:08:02.518668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11000c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127261f0>]}
[0m21:08:02.518857 [debug] [MainThread]: Flushing usage events
[0m21:08:02.616590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:08:08.508439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e502e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf33d0>]}


============================== 21:08:08.510920 | 5251c728-3498-4cf0-90be-5c0ffac903bb ==============================
[0m21:08:08.510920 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:08:08.511342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m21:08:08.628114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f0dac0>]}
[0m21:08:08.659064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d95fa0>]}
[0m21:08:08.660727 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:08:08.731386 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:08:08.829038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:08.829323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:08.865233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104291130>]}
[0m21:08:08.925266 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:08:08.926321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:08:08.937218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a8400>]}
[0m21:08:08.937546 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:08:08.937760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042404c0>]}
[0m21:08:08.938980 [info ] [MainThread]: 
[0m21:08:08.939193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:08.939344 [info ] [MainThread]: 
[0m21:08:08.939609 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:08:08.940082 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:08:08.970206 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:08:08.970469 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:08:08.970635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:09.002481 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m21:08:09.003307 [debug] [ThreadPool]: On list_database_name: Close
[0m21:08:09.004302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:08:09.004580 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:08:09.008681 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:09.008866 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:08:09.009017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:09.031859 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:08:09.032850 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:09.033023 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:08:09.033219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:09.033364 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:09.033507 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:08:09.033719 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:09.034151 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:08:09.034301 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:08:09.034435 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:08:09.034616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:08:09.034766 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:08:09.038835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:08:09.042785 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:08:09.042966 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:08:09.043117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:08:09.066910 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:08:09.067155 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:08:09.067317 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:08:09.073506 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:08:09.074289 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:08:09.075672 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:08:09.075831 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:08:09.077133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438b370>]}
[0m21:08:09.077385 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:09.077530 [debug] [MainThread]: On master: BEGIN
[0m21:08:09.077660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:09.100979 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:08:09.101237 [debug] [MainThread]: On master: COMMIT
[0m21:08:09.101397 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:09.101540 [debug] [MainThread]: On master: COMMIT
[0m21:08:09.101728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:09.101887 [debug] [MainThread]: On master: Close
[0m21:08:09.103224 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:08:09.103600 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:08:09.103876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:08:09.104065 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:08:09.109436 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.109888 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:08:09.124718 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.124930 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:08:09.125109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:08:09.149342 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:08:09.149638 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.149826 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:08:09.150325 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:09.150974 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.151166 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:08:09.168791 [debug] [Thread-1  ]: SQL status: OK in 0.017 seconds
[0m21:08:09.174086 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.174514 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:09.174774 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://historical-forecast-api.open-meteo.com/v1/forecast',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-2) day)::string,
          'end_date':current_date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:08:39.784134 [debug] [Thread-1  ]: SQL status: OK in 30.609 seconds
[0m21:08:39.795075 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:39.795561 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:08:39.796956 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:08:39.800368 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:39.800754 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:08:39.801241 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:39.806167 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:39.806501 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * from "database_name"."main"."open_meteo_raw_data")
      
[0m21:08:39.807586 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:08:39.817747 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:08:39.818036 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:39.818285 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:08:39.818991 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:39.823770 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:08:39.824036 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:08:39.824763 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:08:39.826533 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:08:39.831388 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5251c728-3498-4cf0-90be-5c0ffac903bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ef0970>]}
[0m21:08:39.831928 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 30.73s]
[0m21:08:39.832319 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:08:39.832973 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:39.833164 [debug] [MainThread]: On master: BEGIN
[0m21:08:39.833329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:39.858635 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m21:08:39.858933 [debug] [MainThread]: On master: COMMIT
[0m21:08:39.859106 [debug] [MainThread]: Using duckdb connection "master"
[0m21:08:39.859263 [debug] [MainThread]: On master: COMMIT
[0m21:08:39.859462 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:08:39.859620 [debug] [MainThread]: On master: Close
[0m21:08:39.860467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:39.860620 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:08:39.860782 [info ] [MainThread]: 
[0m21:08:39.860953 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.92 seconds (30.92s).
[0m21:08:39.861314 [debug] [MainThread]: Command end result
[0m21:08:39.904564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:08:39.905549 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:08:39.909129 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:08:39.909302 [info ] [MainThread]: 
[0m21:08:39.909524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:39.909682 [info ] [MainThread]: 
[0m21:08:39.909854 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:08:39.910780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.449278, "process_in_blocks": "0", "process_kernel_time": 0.394897, "process_mem_max_rss": "147881984", "process_out_blocks": "0", "process_user_time": 2.879442}
[0m21:08:39.910992 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:39.910946 after 31.45 seconds
[0m21:08:39.911192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e502e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103149fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f0dac0>]}
[0m21:08:39.911385 [debug] [MainThread]: Flushing usage events
[0m21:08:40.147176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:08.449594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb33d0>]}


============================== 21:13:08.452470 | 5fc69f9e-8778-44dd-93b5-933c18a497e7 ==============================
[0m21:13:08.452470 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:13:08.452905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'send_anonymous_usage_stats': 'True'}
[0m21:13:08.596286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104909ac0>]}
[0m21:13:08.627674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53fa0>]}
[0m21:13:08.630107 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:13:08.705234 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:13:08.804105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:13:08.804619 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:13:09.065247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66eb0>]}
[0m21:13:09.120913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:13:09.122337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:13:09.162036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dfb9d0>]}
[0m21:13:09.162370 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:13:09.162559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc59a0>]}
[0m21:13:09.163551 [info ] [MainThread]: 
[0m21:13:09.163741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:09.163887 [info ] [MainThread]: 
[0m21:13:09.164141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:13:09.164586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:13:09.199091 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:13:09.199372 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:13:09.199537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:09.291483 [debug] [ThreadPool]: SQL status: OK in 0.092 seconds
[0m21:13:09.292903 [debug] [ThreadPool]: On list_database_name: Close
[0m21:13:09.294574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:13:09.295057 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:13:09.299477 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:09.299694 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:13:09.299854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:09.326570 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m21:13:09.327477 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:09.327651 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:13:09.327856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:09.327997 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:09.328138 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:13:09.328714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:09.329353 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:13:09.329541 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:13:09.329705 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:13:09.329921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:13:09.330073 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:13:09.333981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:13:09.337921 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:13:09.338099 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:13:09.338247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:09.361483 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:13:09.361751 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:13:09.361919 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:13:09.370642 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:13:09.371445 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:13:09.372690 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:13:09.372846 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:13:09.374146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d79880>]}
[0m21:13:09.374406 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:09.374552 [debug] [MainThread]: On master: BEGIN
[0m21:13:09.374686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:09.398614 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:13:09.398900 [debug] [MainThread]: On master: COMMIT
[0m21:13:09.399065 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:09.399213 [debug] [MainThread]: On master: COMMIT
[0m21:13:09.399401 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:09.399557 [debug] [MainThread]: On master: Close
[0m21:13:09.401008 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:09.401350 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:13:09.401643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:13:09.401839 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:09.407232 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.407637 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:09.422406 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.422623 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:13:09.422800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:13:09.446265 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m21:13:09.446572 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.446785 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:13:09.447370 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:09.448146 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.448349 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:13:09.467296 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m21:13:09.472634 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.473058 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:09.473323 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::string,
          'end_date':date_add(current_date, interval (-2) day)::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:13:40.042631 [debug] [Thread-1  ]: SQL status: OK in 30.569 seconds
[0m21:13:40.060034 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:40.060757 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:13:40.062687 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:13:40.067252 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:40.067749 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:13:40.068437 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:40.075300 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:40.075734 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * from "database_name"."main"."open_meteo_raw_data")
      
[0m21:13:40.077437 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:13:40.090432 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:13:40.090791 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:40.091086 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:13:40.092287 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:13:40.098351 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:13:40.098655 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:13:40.099154 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:13:40.101124 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:13:40.106743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc69f9e-8778-44dd-93b5-933c18a497e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ec970>]}
[0m21:13:40.107203 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 30.70s]
[0m21:13:40.107584 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:13:40.108328 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.108581 [debug] [MainThread]: On master: BEGIN
[0m21:13:40.108782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:40.133719 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m21:13:40.133987 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.134152 [debug] [MainThread]: Using duckdb connection "master"
[0m21:13:40.134299 [debug] [MainThread]: On master: COMMIT
[0m21:13:40.134484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:13:40.134637 [debug] [MainThread]: On master: Close
[0m21:13:40.135473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:40.135629 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:13:40.135791 [info ] [MainThread]: 
[0m21:13:40.135958 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.97 seconds (30.97s).
[0m21:13:40.136307 [debug] [MainThread]: Command end result
[0m21:13:40.152515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:13:40.153661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:13:40.158013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:13:40.158250 [info ] [MainThread]: 
[0m21:13:40.158572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:40.158751 [info ] [MainThread]: 
[0m21:13:40.158919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:13:40.160134 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.755476, "process_in_blocks": "0", "process_kernel_time": 0.486815, "process_mem_max_rss": "152027136", "process_out_blocks": "0", "process_user_time": 3.11798}
[0m21:13:40.160357 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:40.160309 after 31.76 seconds
[0m21:13:40.160571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104975b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db3b80>]}
[0m21:13:40.160785 [debug] [MainThread]: Flushing usage events
[0m21:13:40.439323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:09.435746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1ebe0>]}


============================== 21:18:09.438725 | 99c882b0-cad1-48df-a1e3-0477097169b9 ==============================
[0m21:18:09.438725 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:18:09.439151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:09.577784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd4f0>]}
[0m21:18:09.608571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f69d0>]}
[0m21:18:09.610466 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:18:09.698744 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:18:09.793251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:09.793693 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:18:10.043628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e2ee0>]}
[0m21:18:10.099187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:18:10.100461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:18:10.139399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655e6a0>]}
[0m21:18:10.139735 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:18:10.139933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655eac0>]}
[0m21:18:10.140914 [info ] [MainThread]: 
[0m21:18:10.141107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:10.141253 [info ] [MainThread]: 
[0m21:18:10.141507 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:18:10.141947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:18:10.176804 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:18:10.177062 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:18:10.177226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:10.277317 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m21:18:10.278659 [debug] [ThreadPool]: On list_database_name: Close
[0m21:18:10.280352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:18:10.280666 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:18:10.284901 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:18:10.285093 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:18:10.285258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:10.309258 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:18:10.310422 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:18:10.310663 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:18:10.310915 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:18:10.311077 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:18:10.311220 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:18:10.311808 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:18:10.312297 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:18:10.312461 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:18:10.312602 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:18:10.312801 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:18:10.312957 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:18:10.316846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:18:10.320906 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:18:10.321092 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:18:10.321245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:10.351845 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m21:18:10.352152 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:18:10.352320 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:18:10.362130 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:18:10.363068 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:18:10.364557 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:18:10.364722 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:18:10.366260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626b130>]}
[0m21:18:10.366551 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:10.366708 [debug] [MainThread]: On master: BEGIN
[0m21:18:10.366847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:10.390681 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:18:10.390935 [debug] [MainThread]: On master: COMMIT
[0m21:18:10.391095 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:10.391236 [debug] [MainThread]: On master: COMMIT
[0m21:18:10.391424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:18:10.391589 [debug] [MainThread]: On master: Close
[0m21:18:10.393013 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:18:10.393351 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:18:10.393635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:18:10.393826 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:18:10.399313 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.399738 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:18:10.414553 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.414766 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:18:10.414942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:18:10.438501 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m21:18:10.438786 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.438966 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:18:10.439441 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:18:10.440077 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.440260 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:18:10.459267 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m21:18:10.464619 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.465077 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:18:10.465339 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::string,
          'end_date':date_add(current_date, interval (-2) day)::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason')::int as reason,
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:18:41.468062 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::string,
          'end_date':date_add(current_date, interval (-2) day)::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason')::int as reason,
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:18:41.470045 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m21:18:41.471511 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m21:18:41.506740 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m21:18:41.507281 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:18:41.514177 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Conversion Error: Could not convert string 'Bad Request' to INT32
  
  LINE 43:     (res->>'reason')::int as reason,
                               ^
[0m21:18:41.516488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99c882b0-cad1-48df-a1e3-0477097169b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc6a30>]}
[0m21:18:41.517066 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 31.12s]
[0m21:18:41.517555 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:18:41.518002 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Conversion Error: Could not convert string 'Bad Request' to INT32
  
  LINE 43:     (res->>'reason')::int as reason,
                               ^.
[0m21:18:41.518934 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:41.519189 [debug] [MainThread]: On master: BEGIN
[0m21:18:41.519391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:41.547048 [debug] [MainThread]: SQL status: OK in 0.028 seconds
[0m21:18:41.547351 [debug] [MainThread]: On master: COMMIT
[0m21:18:41.547523 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:41.547675 [debug] [MainThread]: On master: COMMIT
[0m21:18:41.547872 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:18:41.548030 [debug] [MainThread]: On master: Close
[0m21:18:41.548970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:41.549217 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:18:41.549413 [info ] [MainThread]: 
[0m21:18:41.549603 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 31.41 seconds (31.41s).
[0m21:18:41.549987 [debug] [MainThread]: Command end result
[0m21:18:41.567830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:18:41.569088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:18:41.572729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:18:41.572902 [info ] [MainThread]: 
[0m21:18:41.573114 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:18:41.573286 [info ] [MainThread]: 
[0m21:18:41.573491 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Conversion Error: Could not convert string 'Bad Request' to INT32
  
  LINE 43:     (res->>'reason')::int as reason,
                               ^
[0m21:18:41.573649 [info ] [MainThread]: 
[0m21:18:41.573826 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:18:41.574811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.18568, "process_in_blocks": "0", "process_kernel_time": 0.515458, "process_mem_max_rss": "148111360", "process_out_blocks": "0", "process_user_time": 3.213112}
[0m21:18:41.575034 [debug] [MainThread]: Command `dbt run` failed at 21:18:41.574991 after 32.19 seconds
[0m21:18:41.575265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403d5b0>]}
[0m21:18:41.575477 [debug] [MainThread]: Flushing usage events
[0m21:18:41.825105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:26.929530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105430250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d3460>]}


============================== 21:19:26.932233 | 7396c37e-f94c-4daa-88e6-c9747453ae88 ==============================
[0m21:19:26.932233 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:19:26.932636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:27.069388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ac8e0>]}
[0m21:19:27.100473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106397be0>]}
[0m21:19:27.102554 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:19:27.173453 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:19:27.271224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:19:27.271652 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:19:27.522761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86ee0>]}
[0m21:19:27.578544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:19:27.579760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:19:27.617919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a99670>]}
[0m21:19:27.618270 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:19:27.618462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a540a0>]}
[0m21:19:27.619473 [info ] [MainThread]: 
[0m21:19:27.619663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:27.619818 [info ] [MainThread]: 
[0m21:19:27.620076 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:19:27.620525 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:19:27.659771 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:19:27.660043 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:19:27.660202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:27.755764 [debug] [ThreadPool]: SQL status: OK in 0.095 seconds
[0m21:19:27.757028 [debug] [ThreadPool]: On list_database_name: Close
[0m21:19:27.758855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:19:27.759150 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:19:27.763318 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:19:27.763506 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:19:27.763657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:27.785871 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m21:19:27.786756 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:19:27.786929 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:19:27.787129 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:27.787276 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:19:27.787424 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:19:27.787864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:27.788306 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:19:27.788457 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:19:27.788591 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:19:27.788770 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:27.788925 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:19:27.792610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:19:27.796467 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:19:27.796644 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:19:27.796784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:27.819814 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:19:27.820066 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:19:27.820227 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:19:27.829156 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:19:27.829964 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:19:27.831159 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:19:27.831325 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:19:27.832614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ed7c0>]}
[0m21:19:27.832876 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:27.833021 [debug] [MainThread]: On master: BEGIN
[0m21:19:27.833155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:27.856225 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:19:27.856510 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.856673 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:27.856814 [debug] [MainThread]: On master: COMMIT
[0m21:19:27.857003 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:27.857154 [debug] [MainThread]: On master: Close
[0m21:19:27.858544 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:19:27.858921 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:19:27.859194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:19:27.859383 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:19:27.864833 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.865282 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:19:27.880066 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.880275 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:19:27.880453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:19:27.903908 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m21:19:27.904223 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.904419 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:19:27.904941 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:19:27.905588 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.905784 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:19:27.923682 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:19:27.928946 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.929376 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:27.929632 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::string,
          'end_date':date_add(current_date, interval (-2) day)::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:19:58.804669 [debug] [Thread-1  ]: SQL status: OK in 30.874 seconds
[0m21:19:58.809371 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:58.809642 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:19:58.810632 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:19:58.812486 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:58.812699 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:19:58.813004 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:19:58.816020 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:58.816252 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:19:58.816878 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:19:58.823860 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:19:58.824096 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:58.824273 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:19:58.824891 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:19:58.828630 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:19:58.828867 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:19:58.829309 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:19:58.830966 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:19:58.836139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7396c37e-f94c-4daa-88e6-c9747453ae88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d08e0>]}
[0m21:19:58.836587 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 30.98s]
[0m21:19:58.836915 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:19:58.837557 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:58.837748 [debug] [MainThread]: On master: BEGIN
[0m21:19:58.837908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:58.862906 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m21:19:58.863196 [debug] [MainThread]: On master: COMMIT
[0m21:19:58.863362 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:58.863514 [debug] [MainThread]: On master: COMMIT
[0m21:19:58.863718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:58.863873 [debug] [MainThread]: On master: Close
[0m21:19:58.864869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:58.865157 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:19:58.865365 [info ] [MainThread]: 
[0m21:19:58.865575 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 31.25 seconds (31.25s).
[0m21:19:58.865986 [debug] [MainThread]: Command end result
[0m21:19:58.883954 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:19:58.885173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:19:58.889018 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:19:58.889225 [info ] [MainThread]: 
[0m21:19:58.889467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:58.889633 [info ] [MainThread]: 
[0m21:19:58.889810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:19:58.890848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.00634, "process_in_blocks": "0", "process_kernel_time": 0.498053, "process_mem_max_rss": "148799488", "process_out_blocks": "0", "process_user_time": 3.054821}
[0m21:19:58.891098 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:58.891049 after 32.01 seconds
[0m21:19:58.891325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105430250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddf520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d5b20>]}
[0m21:19:58.891543 [debug] [MainThread]: Flushing usage events
[0m21:19:59.155834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:14.288808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b08280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ab100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ab430>]}


============================== 21:24:14.291702 | c7f59b4c-107c-4311-adbd-70e5b7f2ce76 ==============================
[0m21:24:14.291702 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:24:14.292130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:24:14.428169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a794f0>]}
[0m21:24:14.461559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10346f9d0>]}
[0m21:24:14.463907 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:24:14.534847 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:24:14.632097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:24:14.632518 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:24:14.884854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425eee0>]}
[0m21:24:14.941508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:24:14.942814 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:24:14.981268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041826a0>]}
[0m21:24:14.981605 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:24:14.981795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104182ac0>]}
[0m21:24:14.982786 [info ] [MainThread]: 
[0m21:24:14.982979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:24:14.983130 [info ] [MainThread]: 
[0m21:24:14.983392 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:24:14.983836 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:24:15.023097 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:24:15.023345 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:24:15.023500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:15.110401 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m21:24:15.111451 [debug] [ThreadPool]: On list_database_name: Close
[0m21:24:15.113204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:24:15.113502 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:24:15.117873 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:24:15.118059 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:24:15.118209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:15.141805 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:24:15.142894 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:24:15.143075 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:24:15.143288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:15.143433 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:24:15.143572 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:24:15.143812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:15.144233 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:24:15.144410 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:24:15.144575 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:24:15.144756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:24:15.144918 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:24:15.148675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:24:15.152569 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:24:15.152749 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:24:15.152910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:15.176875 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:24:15.177183 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:24:15.177356 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:24:15.186407 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:24:15.187257 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:24:15.188704 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:24:15.188950 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:24:15.190423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee6100>]}
[0m21:24:15.190729 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:15.190890 [debug] [MainThread]: On master: BEGIN
[0m21:24:15.191035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:15.214798 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:24:15.215078 [debug] [MainThread]: On master: COMMIT
[0m21:24:15.215238 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:15.215380 [debug] [MainThread]: On master: COMMIT
[0m21:24:15.215567 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:24:15.215721 [debug] [MainThread]: On master: Close
[0m21:24:15.217118 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:24:15.217431 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:24:15.217710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:24:15.217906 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:24:15.223397 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.224077 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:24:15.239893 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.240127 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:24:15.240301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:24:15.264635 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:24:15.265037 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.265293 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:24:15.265936 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:24:15.266705 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.266921 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:24:15.285458 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:24:15.290953 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.291505 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:15.291783 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte
)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:24:51.059701 [debug] [Thread-1  ]: SQL status: OK in 35.767 seconds
[0m21:24:51.065416 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:51.065708 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:24:51.067093 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:24:51.069632 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:51.069922 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:24:51.070334 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:24:51.073815 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:51.074056 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:24:51.087807 [debug] [Thread-1  ]: SQL status: OK in 0.014 seconds
[0m21:24:51.095052 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:24:51.095269 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:51.095451 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:24:51.106877 [debug] [Thread-1  ]: SQL status: OK in 0.011 seconds
[0m21:24:51.111406 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:24:51.111652 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:24:51.112134 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:24:51.113841 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:24:51.135637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f59b4c-107c-4311-adbd-70e5b7f2ce76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e67b20>]}
[0m21:24:51.136168 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 35.92s]
[0m21:24:51.136502 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:24:51.137187 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:51.137378 [debug] [MainThread]: On master: BEGIN
[0m21:24:51.137528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:24:51.162570 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m21:24:51.162859 [debug] [MainThread]: On master: COMMIT
[0m21:24:51.163025 [debug] [MainThread]: Using duckdb connection "master"
[0m21:24:51.163175 [debug] [MainThread]: On master: COMMIT
[0m21:24:51.163364 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:24:51.163515 [debug] [MainThread]: On master: Close
[0m21:24:51.164373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:51.164550 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:24:51.164722 [info ] [MainThread]: 
[0m21:24:51.164899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.18 seconds (36.18s).
[0m21:24:51.165275 [debug] [MainThread]: Command end result
[0m21:24:51.182127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:24:51.183158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:24:51.187489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:24:51.187657 [info ] [MainThread]: 
[0m21:24:51.187878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:51.188036 [info ] [MainThread]: 
[0m21:24:51.188196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:24:51.189140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.946655, "process_in_blocks": "0", "process_kernel_time": 0.562192, "process_mem_max_rss": "200409088", "process_out_blocks": "0", "process_user_time": 3.129646}
[0m21:24:51.189353 [debug] [MainThread]: Command `dbt run` succeeded at 21:24:51.189307 after 36.95 seconds
[0m21:24:51.189557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b08280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005a5a60>]}
[0m21:24:51.189755 [debug] [MainThread]: Flushing usage events
[0m21:24:51.389839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:30:36.741850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff0be0>]}


============================== 21:30:36.745007 | 3f227c09-aa5f-427b-a703-8d97b965967b ==============================
[0m21:30:36.745007 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:30:36.745446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:30:36.886180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cd4f0>]}
[0m21:30:36.918768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac49d0>]}
[0m21:30:36.920845 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:30:36.993730 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:30:37.089152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:30:37.089600 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:30:37.339936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b2ee0>]}
[0m21:30:37.395474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:30:37.396685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:30:37.435684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d16a0>]}
[0m21:30:37.436016 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:30:37.436207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d1ac0>]}
[0m21:30:37.437187 [info ] [MainThread]: 
[0m21:30:37.437376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:37.437530 [info ] [MainThread]: 
[0m21:30:37.437790 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:30:37.438254 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:30:37.476889 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:30:37.477139 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:30:37.477301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:37.559178 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m21:30:37.560374 [debug] [ThreadPool]: On list_database_name: Close
[0m21:30:37.561863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:30:37.562164 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:30:37.566263 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:30:37.566446 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:30:37.566599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:37.590225 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:30:37.591095 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:30:37.591276 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:30:37.591478 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:30:37.591622 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:30:37.591765 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:30:37.592221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:30:37.592714 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:30:37.592882 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:30:37.593027 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:30:37.593219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:30:37.593370 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:30:37.597232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:30:37.601320 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:30:37.601544 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:30:37.601697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:37.625041 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:30:37.625304 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:30:37.625472 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:30:37.632662 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:30:37.633513 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:30:37.634736 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:30:37.634904 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:30:37.636238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653b100>]}
[0m21:30:37.636516 [debug] [MainThread]: Using duckdb connection "master"
[0m21:30:37.636672 [debug] [MainThread]: On master: BEGIN
[0m21:30:37.636806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:37.660798 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:30:37.661092 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.661260 [debug] [MainThread]: Using duckdb connection "master"
[0m21:30:37.661408 [debug] [MainThread]: On master: COMMIT
[0m21:30:37.661596 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:30:37.661753 [debug] [MainThread]: On master: Close
[0m21:30:37.663116 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:30:37.663502 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:30:37.663774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:30:37.663974 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:30:37.669582 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.670265 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:30:37.685762 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.686034 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:30:37.686218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:30:37.709874 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:30:37.710165 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.710359 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:30:37.710839 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:30:37.711716 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.712053 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:30:37.730067 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:30:37.735696 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.736180 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:30:37.736459 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res,
    cities.city
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2,
    city
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    city,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte

)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:31:11.063189 [debug] [Thread-1  ]: SQL status: OK in 33.326 seconds
[0m21:31:11.067459 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:31:11.067681 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:31:11.068593 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:31:11.070283 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:31:11.070470 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:31:11.070740 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:31:11.073545 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:31:11.073749 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:31:11.076050 [debug] [Thread-1  ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:31:11.076241 [debug] [Thread-1  ]: DuckDB adapter: Rolling back transaction.
[0m21:31:11.076475 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: ROLLBACK
[0m21:31:11.091795 [debug] [Thread-1  ]: Failed to rollback 'model.weather_dbt_project.open_meteo_raw_data'
[0m21:31:11.091989 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:31:11.096943 [debug] [Thread-1  ]: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Binder Error: Table "weather_accumulation_data" does not have a column with name "city"
[0m21:31:11.098229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f227c09-aa5f-427b-a703-8d97b965967b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064baa60>]}
[0m21:31:11.098601 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model main.open_meteo_raw_data ................. [[31mERROR[0m in 33.43s]
[0m21:31:11.098924 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:31:11.099221 [debug] [Thread-4  ]: Marking all children of 'model.weather_dbt_project.open_meteo_raw_data' to be skipped because of status 'error'.  Reason: Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Binder Error: Table "weather_accumulation_data" does not have a column with name "city".
[0m21:31:11.099839 [debug] [MainThread]: Using duckdb connection "master"
[0m21:31:11.100000 [debug] [MainThread]: On master: BEGIN
[0m21:31:11.100137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:11.124164 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:31:11.124412 [debug] [MainThread]: On master: COMMIT
[0m21:31:11.124567 [debug] [MainThread]: Using duckdb connection "master"
[0m21:31:11.124706 [debug] [MainThread]: On master: COMMIT
[0m21:31:11.124887 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:31:11.125040 [debug] [MainThread]: On master: Close
[0m21:31:11.125931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:11.126193 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:31:11.126368 [info ] [MainThread]: 
[0m21:31:11.126539 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 33.69 seconds (33.69s).
[0m21:31:11.126888 [debug] [MainThread]: Command end result
[0m21:31:11.146109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:31:11.147387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:31:11.151108 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:31:11.151297 [info ] [MainThread]: 
[0m21:31:11.151526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:31:11.151696 [info ] [MainThread]: 
[0m21:31:11.151900 [error] [MainThread]:   Runtime Error in model open_meteo_raw_data (models/open_meteo_raw_data.sql)
  Binder Error: Table "weather_accumulation_data" does not have a column with name "city"
[0m21:31:11.152054 [info ] [MainThread]: 
[0m21:31:11.152222 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:31:11.153219 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.45854, "process_in_blocks": "0", "process_kernel_time": 0.476907, "process_mem_max_rss": "194412544", "process_out_blocks": "0", "process_user_time": 35.609085}
[0m21:31:11.153452 [debug] [MainThread]: Command `dbt run` failed at 21:31:11.153398 after 34.46 seconds
[0m21:31:11.153677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430d5b0>]}
[0m21:31:11.153887 [debug] [MainThread]: Flushing usage events
[0m21:31:11.415992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:40.335034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b32f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b32bb0>]}


============================== 21:33:40.338299 | caa81a3e-a8e4-4958-9291-f4dd8af87201 ==============================
[0m21:33:40.338299 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:33:40.338835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:33:40.473450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301c8e0>]}
[0m21:33:40.504257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c07be0>]}
[0m21:33:40.506706 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:33:40.576506 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:33:40.671015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:40.671241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:40.704548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e1130>]}
[0m21:33:40.761222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:33:40.762465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:33:40.773260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fb490>]}
[0m21:33:40.773546 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:33:40.773733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a8280>]}
[0m21:33:40.774700 [info ] [MainThread]: 
[0m21:33:40.774892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:33:40.775045 [info ] [MainThread]: 
[0m21:33:40.775309 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:33:40.775736 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:33:40.810546 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:33:40.810809 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:33:40.810984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:40.887564 [debug] [ThreadPool]: SQL status: OK in 0.077 seconds
[0m21:33:40.888468 [debug] [ThreadPool]: On list_database_name: Close
[0m21:33:40.890061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:33:40.890357 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:33:40.894488 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:33:40.894675 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:33:40.894828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:40.916850 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m21:33:40.917931 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:33:40.918102 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:33:40.918297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:33:40.918442 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:33:40.918578 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:33:40.919029 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:33:40.919459 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:33:40.919608 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:33:40.919744 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:33:40.919921 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:33:40.920069 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:33:40.923744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:33:40.927562 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:33:40.927749 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:33:40.927894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:40.951432 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:33:40.951704 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:33:40.951873 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:33:40.959613 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:33:40.960513 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:33:40.961788 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:33:40.961964 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:33:40.963335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10282bbe0>]}
[0m21:33:40.963643 [debug] [MainThread]: Using duckdb connection "master"
[0m21:33:40.963811 [debug] [MainThread]: On master: BEGIN
[0m21:33:40.963950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:40.987967 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:33:40.988228 [debug] [MainThread]: On master: COMMIT
[0m21:33:40.988389 [debug] [MainThread]: Using duckdb connection "master"
[0m21:33:40.988528 [debug] [MainThread]: On master: COMMIT
[0m21:33:40.988758 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:33:40.988911 [debug] [MainThread]: On master: Close
[0m21:33:40.990215 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:33:40.990535 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:33:40.990792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:33:40.990978 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:33:40.996407 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:40.996859 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:33:41.011671 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:41.011884 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:33:41.012059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:33:41.035733 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:33:41.036031 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:41.036213 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:33:41.036737 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:33:41.037381 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:41.037577 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:33:41.056040 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:33:41.061658 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:41.062093 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:33:41.062357 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res,
    cities.city
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2,
    city
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    city,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte

)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:34:13.680068 [debug] [Thread-1  ]: SQL status: OK in 32.617 seconds
[0m21:34:13.685943 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:34:13.686258 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:34:13.687374 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:34:13.689744 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:34:13.689990 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:34:13.690337 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:34:13.693967 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:34:13.694230 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:34:13.705502 [debug] [Thread-1  ]: SQL status: OK in 0.011 seconds
[0m21:34:13.713310 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:34:13.713533 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:34:13.713723 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:34:13.717019 [debug] [Thread-1  ]: SQL status: OK in 0.003 seconds
[0m21:34:13.721052 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:34:13.721271 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:34:13.721763 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:34:13.723220 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:34:13.737992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caa81a3e-a8e4-4958-9291-f4dd8af87201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ae160>]}
[0m21:34:13.738404 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 32.75s]
[0m21:34:13.738717 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:34:13.739339 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:13.739523 [debug] [MainThread]: On master: BEGIN
[0m21:34:13.739670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:13.763076 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:34:13.763323 [debug] [MainThread]: On master: COMMIT
[0m21:34:13.763477 [debug] [MainThread]: Using duckdb connection "master"
[0m21:34:13.763616 [debug] [MainThread]: On master: COMMIT
[0m21:34:13.763796 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:34:13.763952 [debug] [MainThread]: On master: Close
[0m21:34:13.764803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:13.765045 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:34:13.765222 [info ] [MainThread]: 
[0m21:34:13.765394 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 32.99 seconds (32.99s).
[0m21:34:13.765749 [debug] [MainThread]: Command end result
[0m21:34:13.809270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:34:13.810904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:34:13.814487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:34:13.814662 [info ] [MainThread]: 
[0m21:34:13.814890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:13.815051 [info ] [MainThread]: 
[0m21:34:13.815248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:34:13.816244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.52548, "process_in_blocks": "0", "process_kernel_time": 0.49135, "process_mem_max_rss": "192004096", "process_out_blocks": "0", "process_user_time": 2.864487}
[0m21:34:13.816447 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:13.816401 after 33.53 seconds
[0m21:34:13.816649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e23370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee38b0>]}
[0m21:34:13.816838 [debug] [MainThread]: Flushing usage events
[0m21:34:14.119044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:27.663843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105128310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbabe0>]}


============================== 21:35:27.666771 | 6e128b00-2886-4669-a9f6-6761e9986301 ==============================
[0m21:35:27.666771 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:35:27.667177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:27.805177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e51f0>]}
[0m21:35:27.836261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e31070>]}
[0m21:35:27.838230 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:35:27.909180 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:35:28.006138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:28.006385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:28.039738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106568130>]}
[0m21:35:28.096183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:35:28.097388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:35:28.108947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8ca30>]}
[0m21:35:28.109237 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:35:28.109440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d4a00>]}
[0m21:35:28.110446 [info ] [MainThread]: 
[0m21:35:28.110641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:28.110794 [info ] [MainThread]: 
[0m21:35:28.111064 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:35:28.111528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:35:28.152277 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:35:28.152552 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:35:28.152713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:28.263638 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m21:35:28.265078 [debug] [ThreadPool]: On list_database_name: Close
[0m21:35:28.266703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:35:28.267014 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:35:28.271349 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:35:28.271532 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:35:28.271686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:28.295358 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m21:35:28.296539 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:35:28.296712 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:35:28.296940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:35:28.297090 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:35:28.297238 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:35:28.297788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:35:28.298271 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:35:28.298433 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:35:28.298573 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:35:28.298763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:35:28.298914 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:35:28.302673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:35:28.306609 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:35:28.306792 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:35:28.306934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:28.330379 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:35:28.330606 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:35:28.330763 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:35:28.341065 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:35:28.341855 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:35:28.343072 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:35:28.343234 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:35:28.344572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b6640>]}
[0m21:35:28.344846 [debug] [MainThread]: Using duckdb connection "master"
[0m21:35:28.344999 [debug] [MainThread]: On master: BEGIN
[0m21:35:28.345134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:28.368008 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:35:28.368267 [debug] [MainThread]: On master: COMMIT
[0m21:35:28.368422 [debug] [MainThread]: Using duckdb connection "master"
[0m21:35:28.368572 [debug] [MainThread]: On master: COMMIT
[0m21:35:28.368771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:35:28.368928 [debug] [MainThread]: On master: Close
[0m21:35:28.370129 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:35:28.370424 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:35:28.370665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:35:28.370846 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:35:28.376168 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.376899 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:35:28.391607 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.391814 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:35:28.391986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:35:28.415163 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m21:35:28.415474 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.415664 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:35:28.416237 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:35:28.417029 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.417247 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:35:28.436152 [debug] [Thread-1  ]: SQL status: OK in 0.019 seconds
[0m21:35:28.441702 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.442171 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:35:28.442440 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,evapotranspiration,wind_speed_10m,soil_temperature_0cm,soil_moisture_0_to_1cm',
          'timezone':'America/New_York'
        }
    ) AS res,
    cities.city
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2,
    city
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    city,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'evapotranspiration')::float[]) as evapotranspiration,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0cm')::float[]) as soil_temperature_0cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_1cm')::float[]) as soil_moisture_0_to_1cm
  FROM
    cte

)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:36:00.546608 [debug] [Thread-1  ]: SQL status: OK in 32.104 seconds
[0m21:36:00.551753 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:36:00.552039 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:36:00.553114 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:36:00.555300 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:36:00.555530 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:36:00.555845 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:36:00.559109 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:36:00.559347 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:36:00.573252 [debug] [Thread-1  ]: SQL status: OK in 0.014 seconds
[0m21:36:00.580391 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:36:00.580606 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:36:00.580785 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:36:00.593179 [debug] [Thread-1  ]: SQL status: OK in 0.012 seconds
[0m21:36:00.596979 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:36:00.597201 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:36:00.597677 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:36:00.599095 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:36:00.624792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e128b00-2886-4669-a9f6-6761e9986301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c89a0>]}
[0m21:36:00.625222 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 32.25s]
[0m21:36:00.625534 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:36:00.626242 [debug] [MainThread]: Using duckdb connection "master"
[0m21:36:00.626427 [debug] [MainThread]: On master: BEGIN
[0m21:36:00.626569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:00.649885 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m21:36:00.650142 [debug] [MainThread]: On master: COMMIT
[0m21:36:00.650293 [debug] [MainThread]: Using duckdb connection "master"
[0m21:36:00.650429 [debug] [MainThread]: On master: COMMIT
[0m21:36:00.650607 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:36:00.650752 [debug] [MainThread]: On master: Close
[0m21:36:00.651506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:00.651646 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:36:00.651804 [info ] [MainThread]: 
[0m21:36:00.651967 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 32.54 seconds (32.54s).
[0m21:36:00.652316 [debug] [MainThread]: Command end result
[0m21:36:00.694369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:36:00.695351 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:36:00.698898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:36:00.699070 [info ] [MainThread]: 
[0m21:36:00.699291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:00.699452 [info ] [MainThread]: 
[0m21:36:00.699621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:36:00.700571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 33.080917, "process_in_blocks": "0", "process_kernel_time": 0.491442, "process_mem_max_rss": "195592192", "process_out_blocks": "0", "process_user_time": 2.938355}
[0m21:36:00.700775 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:00.700732 after 33.08 seconds
[0m21:36:00.700963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105128310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8ca30>]}
[0m21:36:00.701154 [debug] [MainThread]: Flushing usage events
[0m21:36:00.902724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:46.797344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106573130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106573460>]}


============================== 21:44:46.800254 | 3c7eb87e-1164-4e0d-9b48-87fc0b4f5936 ==============================
[0m21:44:46.800254 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:44:46.800679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'profiles_dir': '.', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . -s ./models/open_meteo_raw_data.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:46.938729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f47be0>]}
[0m21:44:46.969875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677bb20>]}
[0m21:44:46.971824 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m21:44:47.041594 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:44:47.138152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:44:47.138585 [debug] [MainThread]: Partial parsing: updated file: weather_dbt_project://models/open_meteo_raw_data.sql
[0m21:44:47.390032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127eb0>]}
[0m21:44:47.445791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:44:47.447100 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:44:47.485177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4a1c0>]}
[0m21:44:47.485514 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m21:44:47.485713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f970d0>]}
[0m21:44:47.486723 [info ] [MainThread]: 
[0m21:44:47.486911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:47.487072 [info ] [MainThread]: 
[0m21:44:47.487331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:44:47.487781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m21:44:47.526744 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m21:44:47.527007 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m21:44:47.527164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:47.634060 [debug] [ThreadPool]: SQL status: OK in 0.107 seconds
[0m21:44:47.635376 [debug] [ThreadPool]: On list_database_name: Close
[0m21:44:47.637323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m21:44:47.637628 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m21:44:47.641981 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:44:47.642173 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m21:44:47.642327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:47.665729 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:44:47.666620 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:44:47.666791 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m21:44:47.667038 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:44:47.667187 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:44:47.667333 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m21:44:47.667609 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:44:47.668050 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:44:47.668199 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m21:44:47.668335 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m21:44:47.668518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:44:47.668668 [debug] [ThreadPool]: On create_database_name_main: Close
[0m21:44:47.672482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m21:44:47.676327 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:44:47.676515 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m21:44:47.676659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:47.698893 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m21:44:47.699130 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m21:44:47.699289 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m21:44:47.707882 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:44:47.708691 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m21:44:47.709921 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m21:44:47.710090 [debug] [ThreadPool]: On list_database_name_main: Close
[0m21:44:47.711418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbb700>]}
[0m21:44:47.711713 [debug] [MainThread]: Using duckdb connection "master"
[0m21:44:47.711877 [debug] [MainThread]: On master: BEGIN
[0m21:44:47.712017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:47.736561 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:44:47.736813 [debug] [MainThread]: On master: COMMIT
[0m21:44:47.736967 [debug] [MainThread]: Using duckdb connection "master"
[0m21:44:47.737110 [debug] [MainThread]: On master: COMMIT
[0m21:44:47.737294 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:44:47.737441 [debug] [MainThread]: On master: Close
[0m21:44:47.738884 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m21:44:47.739231 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m21:44:47.739525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m21:44:47.739724 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m21:44:47.745144 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.745874 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m21:44:47.760732 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.760948 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m21:44:47.761126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:44:47.785191 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m21:44:47.785495 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.785682 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m21:44:47.786200 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:44:47.786852 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.787045 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m21:44:47.804873 [debug] [Thread-1  ]: SQL status: OK in 0.018 seconds
[0m21:44:47.810187 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.810638 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:44:47.810898 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,wind_speed_10m,soil_temperature_0_to_7cm,soil_moisture_0_to_7cm',
          'timezone':'America/New_York'
        }
    ) AS res,
    cities.city
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2,
    city
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    city,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0_to_7cm')::float[]) as soil_temperature_0_to_7cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_7cm')::float[]) as soil_moisture_0_to_7cm
  FROM
    cte

)
SELECT
  *
FROM
  __response
    );
  
  
[0m21:45:18.266504 [debug] [Thread-1  ]: SQL status: OK in 30.455 seconds
[0m21:45:18.272142 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:45:18.272459 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m21:45:18.273555 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m21:45:18.275648 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:45:18.275875 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m21:45:18.276196 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:45:18.279536 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:45:18.279774 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m21:45:18.293614 [debug] [Thread-1  ]: SQL status: OK in 0.014 seconds
[0m21:45:18.301043 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:45:18.301292 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:45:18.301483 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m21:45:18.308269 [debug] [Thread-1  ]: SQL status: OK in 0.007 seconds
[0m21:45:18.312572 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m21:45:18.312838 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m21:45:18.313425 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m21:45:18.315158 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m21:45:18.339809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c7eb87e-1164-4e0d-9b48-87fc0b4f5936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cac940>]}
[0m21:45:18.340260 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 30.60s]
[0m21:45:18.340595 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m21:45:18.341250 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:18.341416 [debug] [MainThread]: On master: BEGIN
[0m21:45:18.341557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:45:18.365624 [debug] [MainThread]: SQL status: OK in 0.024 seconds
[0m21:45:18.365935 [debug] [MainThread]: On master: COMMIT
[0m21:45:18.366098 [debug] [MainThread]: Using duckdb connection "master"
[0m21:45:18.366261 [debug] [MainThread]: On master: COMMIT
[0m21:45:18.366450 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:45:18.366624 [debug] [MainThread]: On master: Close
[0m21:45:18.367534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:18.367779 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m21:45:18.367956 [info ] [MainThread]: 
[0m21:45:18.368137 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.88 seconds (30.88s).
[0m21:45:18.368504 [debug] [MainThread]: Command end result
[0m21:45:18.384816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m21:45:18.386019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m21:45:18.389780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m21:45:18.389958 [info ] [MainThread]: 
[0m21:45:18.390209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:45:18.390377 [info ] [MainThread]: 
[0m21:45:18.390571 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:45:18.391694 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.639437, "process_in_blocks": "0", "process_kernel_time": 0.515903, "process_mem_max_rss": "195837952", "process_out_blocks": "0", "process_user_time": 3.136511}
[0m21:45:18.391942 [debug] [MainThread]: Command `dbt run` succeeded at 21:45:18.391895 after 31.64 seconds
[0m21:45:18.392147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105128f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10246d910>]}
[0m21:45:18.392366 [debug] [MainThread]: Flushing usage events
[0m21:45:18.590276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:14.301528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10311c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103faff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fafc10>]}


============================== 16:52:14.304829 | ba5fc29b-6f90-4cd0-b947-967fd38df8c5 ==============================
[0m16:52:14.304829 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:52:14.305267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ericliao/climate_elt/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir . -s models/open_meteo_raw_data.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:14.442607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104052790>]}
[0m16:52:14.473486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0c9a0>]}
[0m16:52:14.475459 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:52:14.559326 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:52:14.657524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:14.657786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:14.691276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455c130>]}
[0m16:52:14.749202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m16:52:14.750362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m16:52:14.763630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104576070>]}
[0m16:52:14.763917 [info ] [MainThread]: Found 2 models, 28 data tests, 1 seed, 424 macros
[0m16:52:14.764114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450c7c0>]}
[0m16:52:14.765114 [info ] [MainThread]: 
[0m16:52:14.765311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:14.765466 [info ] [MainThread]: 
[0m16:52:14.765733 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:52:14.766177 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_database_name'
[0m16:52:14.806360 [debug] [ThreadPool]: Using duckdb connection "list_database_name"
[0m16:52:14.806625 [debug] [ThreadPool]: On list_database_name: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"database_name"'
    
  
  
[0m16:52:14.806786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:14.909431 [debug] [ThreadPool]: SQL status: OK in 0.103 seconds
[0m16:52:14.910599 [debug] [ThreadPool]: On list_database_name: Close
[0m16:52:14.912241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_database_name, now create_database_name_main)
[0m16:52:14.912527 [debug] [ThreadPool]: Creating schema "database: "database_name"
schema: "main"
"
[0m16:52:14.916804 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m16:52:14.916990 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='database_name'
        and type='sqlite'
    
  
[0m16:52:14.917145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.940209 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m16:52:14.941392 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m16:52:14.941579 [debug] [ThreadPool]: On create_database_name_main: BEGIN
[0m16:52:14.941804 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.941953 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m16:52:14.942097 [debug] [ThreadPool]: On create_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "create_database_name_main"} */

    
    
        create schema if not exists "database_name"."main"
    
[0m16:52:14.942363 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.942795 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m16:52:14.942948 [debug] [ThreadPool]: Using duckdb connection "create_database_name_main"
[0m16:52:14.943084 [debug] [ThreadPool]: On create_database_name_main: COMMIT
[0m16:52:14.943265 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:52:14.943413 [debug] [ThreadPool]: On create_database_name_main: Close
[0m16:52:14.947239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_database_name_main, now list_database_name_main)
[0m16:52:14.951166 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m16:52:14.951346 [debug] [ThreadPool]: On list_database_name_main: BEGIN
[0m16:52:14.951490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:14.975524 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m16:52:14.975813 [debug] [ThreadPool]: Using duckdb connection "list_database_name_main"
[0m16:52:14.975986 [debug] [ThreadPool]: On list_database_name_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "connection_name": "list_database_name_main"} */
select
      'database_name' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'database_name'
  
[0m16:52:14.984409 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:52:14.985321 [debug] [ThreadPool]: On list_database_name_main: ROLLBACK
[0m16:52:14.986661 [debug] [ThreadPool]: Failed to rollback 'list_database_name_main'
[0m16:52:14.986833 [debug] [ThreadPool]: On list_database_name_main: Close
[0m16:52:14.988239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104666d00>]}
[0m16:52:14.988541 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:14.988707 [debug] [MainThread]: On master: BEGIN
[0m16:52:14.988844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:15.011756 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m16:52:15.012029 [debug] [MainThread]: On master: COMMIT
[0m16:52:15.012186 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:15.012329 [debug] [MainThread]: On master: COMMIT
[0m16:52:15.012514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:52:15.012672 [debug] [MainThread]: On master: Close
[0m16:52:15.014087 [debug] [Thread-1  ]: Began running node model.weather_dbt_project.open_meteo_raw_data
[0m16:52:15.014446 [info ] [Thread-1  ]: 1 of 1 START sql table model main.open_meteo_raw_data .......................... [RUN]
[0m16:52:15.014743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_database_name_main, now model.weather_dbt_project.open_meteo_raw_data)
[0m16:52:15.014956 [debug] [Thread-1  ]: Began compiling node model.weather_dbt_project.open_meteo_raw_data
[0m16:52:15.020480 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.021300 [debug] [Thread-1  ]: Began executing node model.weather_dbt_project.open_meteo_raw_data
[0m16:52:15.036145 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.036355 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: BEGIN
[0m16:52:15.036527 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:15.059690 [debug] [Thread-1  ]: SQL status: OK in 0.023 seconds
[0m16:52:15.059983 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.060167 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        INSTALL http_client FROM community;
      
[0m16:52:15.060706 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:52:15.061370 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.061566 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        LOAD http_client;
      
[0m16:52:15.085806 [debug] [Thread-1  ]: SQL status: OK in 0.024 seconds
[0m16:52:15.091217 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.091874 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:15.092136 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

  
    
    

    create  table
      "database_name"."main"."open_meteo_raw_data__dbt_tmp"
  
    as (
      -- models/open_meteo_raw_data.sql



-- GET Request Example w/ JSON Parsing
WITH __input AS (
  SELECT
    http_get(
        'https://archive-api.open-meteo.com/v1/archive',
        headers => MAP {
          'accept': 'application/json'
        },
        params => MAP {
          'latitude':cities.latitude::string,
          'longitude':cities.longitude::string,
          'start_date':date_add(current_date, interval (-4) day)::date::string,
          'end_date':date_add(current_date, interval (-2) day)::date::string,
          'hourly':'temperature_2m,precipitation,rain,snowfall,surface_pressure,cloud_cover,wind_speed_10m,soil_temperature_0_to_7cm,soil_moisture_0_to_7cm',
          'timezone':'America/New_York'
        }
    ) AS res,
    cities.city
from cities
),
cities as (
  select 
    *
  from
    "database_name"."main"."cities_info"
),
cte as (
  select 
    (res->>'status')::int as status,
    (res->>'reason') as reason,
    (res->>'body')::json as res2,
    city
  from
    __input
),
__response AS (
  SELECT
    status,
    reason,
    city,
    (res2->>'latitude')::float AS latitude,
    (res2->>'longitude')::float AS longitude,
    (res2->>'generationtime_ms')::float AS generationtime_ms,
    (res2->>'utc_offset_seconds')::int AS utc_offset_seconds,
    (res2->>'timezone')::string AS timezone,
    (res2->>'timezone_abbreviation')::string AS timezone_abbreviation,
    (res2->>'elevation')::int AS elevation,
    (res2->'hourly_units')::map(string, string) AS hourly_units,
    unnest((res2->'hourly'->'time')::timestamp[]) as time,
    unnest((res2->'hourly'->'temperature_2m')::float[]) as temperature_2m,
    unnest((res2->'hourly'->'precipitation')::float[]) as precipitation,
    unnest((res2->'hourly'->'rain')::float[]) as rain,
    unnest((res2->'hourly'->'snowfall')::float[]) as snowfall,
    unnest((res2->'hourly'->'surface_pressure')::float[]) as surface_pressure,
    unnest((res2->'hourly'->'cloud_cover')::float[]) as cloud_cover,
    unnest((res2->'hourly'->'wind_speed_10m')::float[]) as wind_speed_10m,
    unnest((res2->'hourly'->'soil_temperature_0_to_7cm')::float[]) as soil_temperature_0_to_7cm,
    unnest((res2->'hourly'->'soil_moisture_0_to_7cm')::float[]) as soil_moisture_0_to_7cm
  FROM
    cte

)
SELECT
  *
FROM
  __response
    );
  
  
[0m16:52:41.383696 [debug] [Thread-1  ]: SQL status: OK in 26.290 seconds
[0m16:52:41.390419 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:41.390703 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data" rename to "open_meteo_raw_data__dbt_backup"
[0m16:52:41.391755 [debug] [Thread-1  ]: SQL status: OK in 0.001 seconds
[0m16:52:41.393864 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:41.394096 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
alter table "database_name"."main"."open_meteo_raw_data__dbt_tmp" rename to "open_meteo_raw_data"
[0m16:52:41.394417 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:52:41.397796 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:41.398035 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */

        insert or ignore into weather_accumulation_data by name (select * exclude (status, reason) from "database_name"."main"."open_meteo_raw_data")
      
[0m16:52:41.411770 [debug] [Thread-1  ]: SQL status: OK in 0.013 seconds
[0m16:52:41.419047 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m16:52:41.419280 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:41.419468 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: COMMIT
[0m16:52:41.432206 [debug] [Thread-1  ]: SQL status: OK in 0.013 seconds
[0m16:52:41.436164 [debug] [Thread-1  ]: Using duckdb connection "model.weather_dbt_project.open_meteo_raw_data"
[0m16:52:41.436386 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_beginner_profile", "target_name": "dev", "node_id": "model.weather_dbt_project.open_meteo_raw_data"} */
drop table if exists "database_name"."main"."open_meteo_raw_data__dbt_backup" cascade
[0m16:52:41.436886 [debug] [Thread-1  ]: SQL status: OK in 0.000 seconds
[0m16:52:41.438582 [debug] [Thread-1  ]: On model.weather_dbt_project.open_meteo_raw_data: Close
[0m16:52:41.466709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba5fc29b-6f90-4cd0-b947-967fd38df8c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021bc970>]}
[0m16:52:41.467352 [info ] [Thread-1  ]: 1 of 1 OK created sql table model main.open_meteo_raw_data ..................... [[32mOK[0m in 26.45s]
[0m16:52:41.467707 [debug] [Thread-1  ]: Finished running node model.weather_dbt_project.open_meteo_raw_data
[0m16:52:41.468525 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:41.468701 [debug] [MainThread]: On master: BEGIN
[0m16:52:41.468855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:41.491718 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m16:52:41.492012 [debug] [MainThread]: On master: COMMIT
[0m16:52:41.492172 [debug] [MainThread]: Using duckdb connection "master"
[0m16:52:41.492315 [debug] [MainThread]: On master: COMMIT
[0m16:52:41.492501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:52:41.492652 [debug] [MainThread]: On master: Close
[0m16:52:41.493531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:41.493679 [debug] [MainThread]: Connection 'model.weather_dbt_project.open_meteo_raw_data' was properly closed.
[0m16:52:41.493868 [info ] [MainThread]: 
[0m16:52:41.494050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 26.73 seconds (26.73s).
[0m16:52:41.494440 [debug] [MainThread]: Command end result
[0m16:52:41.542226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ericliao/climate_elt/dbt/target/manifest.json
[0m16:52:41.543704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ericliao/climate_elt/dbt/target/semantic_manifest.json
[0m16:52:41.547641 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ericliao/climate_elt/dbt/target/run_results.json
[0m16:52:41.547833 [info ] [MainThread]: 
[0m16:52:41.548068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:41.548239 [info ] [MainThread]: 
[0m16:52:41.548427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:52:41.549771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.298092, "process_in_blocks": "0", "process_kernel_time": 0.521469, "process_mem_max_rss": "192036864", "process_out_blocks": "0", "process_user_time": 2.888221}
[0m16:52:41.549994 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:41.549949 after 27.30 seconds
[0m16:52:41.550187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10311c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103416190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1b580>]}
[0m16:52:41.550394 [debug] [MainThread]: Flushing usage events
[0m16:52:41.728180 [debug] [MainThread]: An error was encountered while trying to flush usage events
